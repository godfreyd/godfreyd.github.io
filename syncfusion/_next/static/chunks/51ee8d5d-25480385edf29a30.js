"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[736],{6896:(e,t,i)=>{i.d(t,{L:()=>h});var s=i(310),l=i(193),n=i(3584),r=i(9876),o=i(6217),a=i(8736),h=function(){function e(e,t,i){this.selectedRowIndexes=[],this.selectedRowCellIndexes=[],this.selectedRecords=[],this.preventFocus=!1,this.selectedColumnsIndexes=[],this.checkBoxState=!1,this.isMultiShiftRequest=!1,this.isMultiCtrlRequest=!1,this.isMultiCtrlRequestCell=!1,this.enableSelectMultiTouch=!1,this.clearRowCheck=!1,this.selectRowCheck=!1,this.selectedRowState={},this.unSelectedRowState={},this.totalRecordsCount=0,this.chkAllCollec=[],this.isCheckedOnAdd=!1,this.persistSelectedData=[],this.deSelectedData=[],this.isHdrSelectAllClicked=!1,this.needColumnSelection=!1,this.isCancelDeSelect=!1,this.isPreventCellSelect=!1,this.disableUI=!1,this.isPersisted=!1,this.cmdKeyPressed=!1,this.cellselected=!1,this.isMultiSelection=!1,this.isAddRowsToSelection=!1,this.initialRowSelection=!1,this.isPrevRowSelection=!1,this.isKeyAction=!1,this.isRowDragSelected=!1,this.isPartialSelection=!1,this.rmtHdrChkbxClicked=!1,this.isCheckboxReset=!1,this.isRowDeselect=!1,this.autoFillRLselection=!0,this.bottom="0 0 2px 0",this.top="2px 0 0 0",this.right_bottom="0 2px 2px 0",this.bottom_left="0 0 2px 2px",this.top_right="2px 2px 0 0",this.top_left="2px 0 0 2px",this.top_bottom="2px 0 2px 0",this.top_right_bottom="2px 2px 2px 0",this.top_bottom_left="2px 0 2px 2px",this.top_right_left="2px 2px 0 2px",this.right_bottom_left="0 2px 2px 2px",this.all_border="2px",this.parent=e,this.selectionSettings=t,this.factory=i.getService("rendererFactory"),this.focus=i.getService("focus"),this.addEventListener(),this.wireEvents()}return e.prototype.initializeSelection=function(){this.parent.log("selection_key_missing"),this.render()},e.prototype.onActionBegin=function(e,t){this.parent.trigger(t,this.fDataUpdate(e))},e.prototype.fDataUpdate=function(e){if(!this.isMultiSelection&&(!(0,s.hX)(e.cellIndex)||!(0,s.hX)(e.rowIndex))){var t=this.getRowObj((0,s.hX)(e.rowIndex)?(0,s.hX)(e.cellIndex)?this.currentIndex:e.cellIndex.rowIndex:e.rowIndex);e.foreignKeyData=t.foreignKeyData}return e},e.prototype.onActionComplete=function(e,t){this.parent.trigger(t,this.fDataUpdate(e)),this.isMultiSelection=!1},e.prototype.getModuleName=function(){return"selection"},e.prototype.destroy=function(){var e=this.parent.element;e&&(e.querySelector("."+a.iM)||e.querySelector("."+a.iV))&&(this.hidePopUp(),this.clearSelection(),this.destroyAutoFillElements(),this.removeEventListener(),this.unWireEvents(),s.Jm.remove(this.parent.getContent(),"mousedown",this.mouseDownHandler),s.Jm.remove(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler))},e.prototype.isEditing=function(){return("Normal"===this.parent.editSettings.mode||"Batch"===this.parent.editSettings.mode&&this.parent.editModule&&this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate())&&this.parent.isEdit&&!this.parent.editSettings.showAddNewRow&&!this.parent.isPersistSelection},e.prototype.getCurrentBatchRecordChanges=function(){var e=this.parent;if("Batch"===e.editSettings.mode&&e.editModule){var t=(0,n.pA)(this.parent.getCurrentViewRecords());t="Bottom"===e.editSettings.newRowPosition?t.concat(this.parent.editModule.getBatchChanges()[a.V0]):this.parent.editModule.getBatchChanges()[a.V0].concat(t);for(var i=this.parent.editModule.getBatchChanges()[a.S4],s=this.parent.getPrimaryKeyFieldNames()[0],l=0;l<i.length;l++)for(var r=0;r<t.length;r++)if(i[parseInt(l.toString(),10)][""+s]===t[parseInt(r.toString(),10)][""+s]){t.splice(r,1);break}return t}return this.parent.enableVirtualization&&this.parent.groupSettings.columns.length&&!this.parent.isPersistSelection?e.getCurrentViewRecords().filter(function(e){return void 0===e.key}):e.getCurrentViewRecords()},e.prototype.selectRow=function(e,t){if(this.selectedRowIndexes.length&&this.selectionSettings.enableSimpleMultiRowSelection){this.addRowsToSelection([e]);return}var i,s,l=this.parent,n=l.getRowByIndex(e),o=n&&l.getRowObjectFromUID(n.getAttribute("data-uid"));if(!this.isPartialSelection||!o||!o.isDataRow||o.isSelectable){if(l.enableVirtualization&&e>-1){var a={selectedIndex:e,isAvailable:!0};if(this.parent.notify(r.ghX,a),n&&l.getRowObjectFromUID(n.getAttribute("data-uid")))i=l.getRowObjectFromUID(n.getAttribute("data-uid")).data;else{a.isAvailable&&!l.selectionSettings.persistSelection&&this.parent.getSelectedRecords().length>0&&this.clearRowSelection();return}}else i=this.getRowObj(e).data;if(!(!this.isRowType()||!n||this.isEditing())){var h=n.hasAttribute("aria-selected");if(this.activeTarget(),t&&this.selectedRowIndexes.length){var c="ResetOnRowClick"===this.selectionSettings.checkboxMode,d=!this.parent.isCheckBoxSelection&&"Multiple"===this.selectionSettings.type;t=(!c&&!d||1===this.selectedRowIndexes.length&&(!!c||!!d))&&(!this.isKeyAction||!this.parent.isCheckBoxSelection)&&-1!==this.selectedRowIndexes.indexOf(e)}else t=!1;this.isKeyAction=!1;var p="cancel";if(t){if("ResetOnRowClick"!==this.selectionSettings.checkboxMode&&this.selectionSettings.persistSelection){if(this.rowDeselect(r.Oi0,[o.index],[o.data],[n],[o.foreignKeyData],this.actualTarget),this.isCancelDeSelect)return;this.parent.isCheckBoxSelection||(this.selectedRowIndexes=[],this.selectedRecords=[],this.isRowSelected=!1,this.selectRowIndex(-1)),this.rowDeselect(r.BK8,[o.index],[o.data],[n],[o.foreignKeyData],this.actualTarget,void 0,void 0,void 0)}this.rowSelectingCallBack(s,t,e,i,!1,h,p)(s)}else s={data:i,rowIndex:e,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,row:n,previousRow:l.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked},this.parent.trigger(r.FeU,this.fDataUpdate(s),this.rowSelectingCallBack(s,t,e,i,!1,h,p))}}},e.prototype.rowSelectingCallBack=function(e,t,i,l,n,r,o){var a=this;return function(e){if(!(0,s.hX)(e)&&!0===e[""+o]){a.disableInteracted();return}a.index=i,a.toggle=t,a.data=l,a.removed=n,r&&a.selectionSettings.persistSelection&&"ResetOnRowClick"!==a.selectionSettings.checkboxMode?(a.clearSelectedRow(i),a.selectRowCallBack()):!r&&a.selectionSettings.persistSelection&&"ResetOnRowClick"!==a.selectionSettings.checkboxMode&&a.selectRowCallBack(),"ResetOnRowClick"===a.selectionSettings.checkboxMode&&(a.isCheckboxReset=!0,a.clearSelection()),a.selectionSettings.persistSelection&&"ResetOnRowClick"!==a.selectionSettings.checkboxMode&&(a.parent.isCheckBoxSelection||!a.selectionSettings.persistSelection)||(a.selectRowCheck=!0,a.clearRow())}},e.prototype.selectRowCallBack=function(){var e,t=this.parent,i=this.index,s=this.toggle,l=this.data,n=this.removed,o=t.getRowByIndex(i);s||n||(-1>=this.selectedRowIndexes.indexOf(i)&&this.updateRowSelection(o,i),this.selectRowIndex(i)),s||(e={data:l,rowIndex:i,row:o,previousRow:t.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,isInteracted:this.isInteracted,isHeaderCheckBoxClicked:this.isHeaderCheckboxClicked,rowIndexes:i},this.onActionComplete(e,r.CZL)),this.isInteracted=!1,this.updateRowProps(i)},e.prototype.selectRowsByRange=function(e,t){this.selectRows(this.getCollectionFromIndexes(e,t)),this.selectRowIndex(t)},e.prototype.selectedDataUpdate=function(e,t,i,s,l){for(var n=0,r=s.length;n<r;n++){var o=this.parent.getDataRows()[s[parseInt(n.toString(),10)]];this.parent.enableVirtualization&&(o=this.parent.getRowByIndex(s[parseInt(n.toString(),10)]));var a=this.getRowObj(o);a&&a.isDataRow&&a.isSelectable?(e.push(a.data),i.push(o),t.push(a.foreignKeyData)):this.isPartialSelection&&l&&l.splice(l.indexOf(s[parseInt(n.toString(),10)]),1)}},e.prototype.selectRows=function(e){var t=this,i=this.parent,l=e.slice(),n=this.isSingleSel()?e[e.length-1]:e[0];this.isMultiSelection=!0;var o=[],a=[],h=[];if(!(!this.isRowType()||this.isEditing())){this.selectedDataUpdate(h,a,o,e,l),this.activeTarget();var c={cancel:!1,rowIndexes:l,row:o,rowIndex:n,target:this.actualTarget,prevRow:i.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isInteracted:this.isInteracted,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,data:h,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,foreignKeyData:a};this.parent.trigger(r.FeU,this.fDataUpdate(c),function(e){if(!(0,s.hX)(e)&&!0===e.cancel){t.disableInteracted();return}t.selectionSettings.persistSelection&&i.allowRowDragAndDrop&&t.isDragged||t.clearRow(),t.selectRowIndex(l.slice(-1)[0]);var h=function(e,s){t.updateRowSelection(i.getRowByIndex(e),e,s),t.updateRowProps(n)};if(t.isSingleSel())h(n);else for(var c=0;c<l.length;c++)h(l[c],!!i.enableVirtualization);e={rowIndexes:l,row:o,rowIndex:n,target:t.actualTarget,prevRow:i.getRows()[t.prevRowIndex],previousRowIndex:t.prevRowIndex,data:t.getSelectedRecords(),isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,foreignKeyData:a},t.isRowSelected&&t.onActionComplete(e,r.CZL),t.isInteracted=!1})}},e.prototype.addRowsToSelection=function(e){var t,i=this.parent,l=this.target;this.isMultiSelection=!0;var n=[],o=[],a=[],h=i.getSelectedRowIndexes().concat(e),c=this.isSingleSel()?i.getRowByIndex(e[e.length-1]):i.getRowByIndex(e[0]);if(!(!this.isRowType()||this.isEditing())||this.selectionSettings.checkboxOnly){var d=this.parent.getColumns().filter(function(e){return"checkbox"===e.type});this.isMultiCtrlRequest&&!d.length&&this.selectedDataUpdate(a,o,n,h);for(var p=0;p<e.length;p++){var g=e[p],u=this.getRowObj(g),C=this.selectedRowIndexes.indexOf(g)>-1;if(!this.isPartialSelection||!u||!u.isDataRow||u.isSelectable){if(this.selectRowIndex(g),C&&(d.length||this.selectionSettings.enableToggle||this.isMultiCtrlRequest)){if(this.isAddRowsToSelection=!0,this.rowDeselect(r.Oi0,[g],[u.data],[c],[u.foreignKeyData],l),this.isCancelDeSelect)return;this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(g),1),this.selectedRecords.splice(this.selectedRecords.indexOf(c),1),this.selectRowIndex(this.selectedRowIndexes.length?this.selectedRowIndexes[this.selectedRowIndexes.length-1]:-1),c.removeAttribute("aria-selected"),this.addRemoveClassesForRow(c,!1,null,"e-selectionbackground","e-active"),this.rowDeselect(r.BK8,[g],[u.data],[c],[u.foreignKeyData],l,void 0,void 0,void 0),this.isInteracted=!1,this.isMultiSelection=!1,this.isAddRowsToSelection=!1,this.isHdrSelectAllClicked=!1}else{if(this.activeTarget(),t={cancel:!1,data:a.length?a:u.data,rowIndex:g,row:n.length?n:c,target:this.actualTarget,prevRow:i.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,foreignKeyData:o.length?o:u.foreignKeyData,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,rowIndexes:h},this.parent.trigger(r.FeU,this.fDataUpdate(t)),!(0,s.hX)(t)&&!0===t.cancel){this.disableInteracted();return}this.isSingleSel()&&this.clearRow(),this.updateRowSelection(c,g)}if(C||(t={data:a.length?a:u.data,rowIndex:g,row:n.length?n:c,target:this.actualTarget,prevRow:i.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,foreignKeyData:o.length?o:u.foreignKeyData,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,rowIndexes:h},this.onActionComplete(t,r.CZL)),this.isInteracted=!1,this.updateRowProps(g),this.isSingleSel())break}}}},e.prototype.getCollectionFromIndexes=function(e,t){for(var i=[],s=e<=t?{i:e,max:t}:{i:t,max:e},l=s.i,n=s.max;l<=n;l++)i.push(l);return e>t&&i.reverse(),i},e.prototype.clearRow=function(){this.clearRowCheck=!0,this.clearRowSelection()},e.prototype.clearRowCallBack=function(){(!this.isCancelDeSelect||"Check"===this.parent.checkAllRows)&&(this.selectedRowIndexes=[],this.selectedRecords=[],this.selectRowIndex(-1),this.isSingleSel()&&this.parent.isPersistSelection&&(this.selectedRowState={}))},e.prototype.clearSelectedRow=function(e){if(this.toggle){var t=this.parent.getRowByIndex(e);this.disableUI||(t.removeAttribute("aria-selected"),this.addRemoveClassesForRow(t,!1,!0,"e-selectionbackground","e-active")),this.removed=!0,this.updatePersistCollection(t,!1),this.updateCheckBoxes(t),this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(e),1),this.selectedRecords.splice(this.selectedRecords.indexOf(this.parent.getRowByIndex(e)),1)}},e.prototype.updateRowProps=function(e){this.prevRowIndex=e,this.isRowSelected=this.selectedRowIndexes.length&&!0},e.prototype.getPkValue=function(e,t){return e&&(0,n.DL)(e)?(0,n.iM)(e,t):t[""+e]},e.prototype.updatePersistCollection=function(e,t){var i=this;if((this.parent.isPersistSelection||this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0)&&!(0,s.hX)(e)){this.parent.isPersistSelection||this.ensureCheckboxFieldSelection();var l=this.getRowObj(e),n=l.data?this.getPkValue(this.primaryKey,l.data):null;if(null===n)return;l.isSelected=t,t&&!this.isPartialSelection||this.isPartialSelection&&l.isSelectable&&l.isSelected?(this.selectedRowState[""+n]=t,delete this.unSelectedRowState[""+n],this.persistSelectedData.some(function(e){return i.getPkValue(i.primaryKey,e)===n})||this.persistSelectedData.push(l.data)):this.updatePersistDelete(n)}},e.prototype.updatePersistDelete=function(e,t){var i,s=this;delete this.selectedRowState[""+e],this.rmtHdrChkbxClicked&&(this.unSelectedRowState[""+e]=!0),this.persistSelectedData.some(function(t,l){return i=l,s.getPkValue(s.primaryKey,t)===e})&&(this.persistSelectedData.splice(i,1),t&&this.parent.partialSelectedRecords.splice(i,1))},e.prototype.updateCheckBoxes=function(e,t,i){if(!(0,s.hX)(e)){var l=e.querySelector(".e-checkselect");(0,s.hX)(l)||((0,n.Cd)(l.nextElementSibling,t),(0,n.Go)(l,t),!(0,s.hX)(this.checkedTarget)&&((0,s.hX)(this.checkedTarget)||this.checkedTarget.classList.contains("e-checkselectall"))||this.setCheckAllState(i))}},e.prototype.updateRowSelection=function(e,t,i){if(e){if(-1===this.selectedRowIndexes.indexOf(t)&&(this.selectedRowIndexes.push(t),this.selectedRecords.push(e)),e.setAttribute("aria-selected","true"),this.updatePersistCollection(e,!0),this.updateCheckBoxes(e,!0),this.addRemoveClassesForRow(e,!0,null,"e-selectionbackground","e-active"),this.preventFocus||this.parent.isFocusFirstCell){if(this.parent.isFocusFirstCell){this.parent.isFocusFirstCell=!1;var s=e.querySelector(".e-selectionbackground.e-rowcell:not(.e-hide, .e-detailrowcollapse, .e-detailrowexpand, .e-rowdragdrop, .e-gridchkbox)");s&&this.focus.onClick({target:s},!0,!0)}}else{var s=this.focus.getPrevIndexes().cellIndex?e.cells[this.focus.getPrevIndexes().cellIndex]:e.querySelector(".e-selectionbackground:not(.e-hide):not(.e-detailrowcollapse):not(.e-detailrowexpand)");if(this.parent.contextMenuModule&&2===this.mouseButton&&(s=this.parent.contextMenuModule.cell),!s||i)return;this.focus.onClick({target:s},!0)}}},e.prototype.clearSelection=function(){if(this.checkSelectAllClicked=!0,this.selectionSettings.persistSelection&&this.persistSelectedData.length&&(this.deSelectedData=(0,n.pA)(this.persistSelectedData)),!this.parent.isPersistSelection||this.parent.isPersistSelection&&!this.parent.isEdit||!(0,s.hX)(this.checkedTarget)&&this.checkedTarget.classList.contains("e-checkselectall")){var e=this.parent.element.querySelector(".e-gridpopup").querySelector("span");e.classList.contains("e-rowselect")&&e.classList.remove("e-spanclicked"),this.parent.isPersistSelection&&(this.persistSelectedData=[],this.selectedRowState={}),this.clearRowSelection(),this.clearCellSelection(),this.clearColumnSelection(),this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevECIdxs=void 0,this.enableSelectMultiTouch=!1,this.isInteracted=!1,this.checkSelectAllClicked=!1,this.isHdrSelectAllClicked=!1}},e.prototype.clearRowSelection=function(){var e=this;if(this.isRowSelected){var t=this.parent.getDataRows(),i=[],s=[],l=[],n=[],o=this.target;this.isRowDeselect=!0;for(var a=0,h=this.selectedRowIndexes.length;a<h;a++){var c=void 0;c=this.parent.enableVirtualization||this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache?this.parent.getRowByIndex(this.selectedRowIndexes[parseInt(a.toString(),10)]):"Batch"===this.parent.editSettings.mode?this.parent.getRows()[this.selectedRowIndexes[parseInt(a.toString(),10)]]:this.parent.getDataRows()[this.selectedRowIndexes[parseInt(a.toString(),10)]];var d=this.getRowObj(c);d&&(i.push(d.data),s.push(c),l.push(this.selectedRowIndexes[parseInt(a.toString(),10)]),n.push(d.foreignKeyData))}this.selectionSettings.persistSelection&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode&&(this.isRowClicked=!!this.checkSelectAllClicked),this.rowDeselect(r.Oi0,l,i,s,n,o,null,function(){if(e.isCancelDeSelect&&(e.isRowClicked||e.checkSelectAllClicked||e.isInteracted&&!e.parent.isPersistSelection)){if(e.parent.isPersistSelection){if("Intermediate"===e.getCheckAllStatus(e.parent.element.querySelector(".e-checkselectall"))||e.parent.isPersistSelection)for(var a=0;a<e.selectedRecords.length;a++)e.updatePersistCollection(e.selectedRecords[parseInt(a.toString(),10)],!0);else e.parent.checkAllRows="Check",e.updatePersistSelectedData(!0)}e.clearRowCheck&&(e.clearRowCallBack(),e.clearRowCheck=!1,e.selectRowCheck&&(e.selectRowCallBack(),e.selectRowCheck=!1));return}for(var h=[].slice.call(t.filter(function(e){return e.hasAttribute("aria-selected")})),c=0;c<h.length;c++)e.disableUI||(h[parseInt(c.toString(),10)].removeAttribute("aria-selected"),e.addRemoveClassesForRow(h[parseInt(c.toString(),10)],!1,!0,"e-selectionbackground","e-active")),e.isPrevRowSelection||e.updatePersistCollection(h[parseInt(c.toString(),10)],!1),e.updateCheckBoxes(h[parseInt(c.toString(),10)]);e.selectedRowIndexes=[],e.selectedRecords=[],e.isRowSelected=!1,e.selectRowIndex(-1),e.isPrevRowSelection=!1,e.rowDeselect(r.BK8,l,i,s,n,o,null,void 0,null),e.clearRowCheck&&(e.clearRowCallBack(),e.clearRowCheck=!1,e.selectRowCheck&&(e.selectRowCallBack(),e.selectRowCheck=!1))},null),this.isRowDeselect=!1}else this.clearRowCheck&&(this.clearRowCallBack(),this.clearRowCheck=!1,this.selectRowCheck&&(this.selectRowCallBack(),this.selectRowCheck=!1))},e.prototype.rowDeselect=function(e,t,i,l,n,r,o,a,h){var c=this;if(this.selectionSettings.persistSelection&&(this.isRowClicked||!this.isRowDeselect||this.checkSelectAllClicked||this.focus.activeKey&&this.focus.currentInfo.element.classList.contains("e-gridchkbox")&&"space"===this.focus.activeKey)||!this.selectionSettings.persistSelection){var d=1===t.length&&1===this.deSelectedData.length,p={rowIndex:t[0],data:this.selectionSettings.persistSelection&&"Uncheck"===this.parent.checkAllRows&&!d&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode?this.deSelectedData:i,foreignKeyData:n,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked};"rowDeselected"===e&&delete p.cancel;var g="rowIndexes",u="data",C="foreignKeyData";p.row=l,p.target=this.actualTarget,this.actualTarget&&!(0,s.hX)((0,s.kp)(this.actualTarget,"thead"))||t.length>1?(p.rowIndex=t[0],p[""+g]=t):1===t.length&&(p[""+u]=p[""+u][0],p.row=p.row[0],p[""+C]=p[""+C][0],this.isAddRowsToSelection&&(p[""+g]=t)),this.parent.trigger(e,p,function(e){c.isCancelDeSelect=e.cancel,c.isCancelDeSelect&&(c.isRowClicked||c.isInteracted||c.checkSelectAllClicked)||(c.updatePersistCollection(l[0],!1),c.updateCheckBoxes(l[0],void 0,t[0])),void 0!==a&&a()})}else this.selectionSettings.persistSelection&&!this.isInteracted&&void 0!==a&&a()},e.prototype.getRowObj=function(e){return(void 0===e&&(e=this.currentIndex),(0,s.hX)(e))?{}:("number"==typeof e&&(e=this.parent.getRowByIndex(e)),e&&this.parent.getRowObjectFromUID(e.getAttribute("data-uid"))||{})},e.prototype.selectCell=function(e,t){if(!(!this.isCellType()||this.isCellType()&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache))){var i,l=this.parent.getCellFromIndex(e.rowIndex,this.getColIndex(e.rowIndex,e.cellIndex));this.currentIndex=e.rowIndex;var n=this.getCurrentBatchRecordChanges()[this.currentIndex];if(!(!this.isCellType()||!l||this.isEditing())){var o=l.classList.contains("e-cellselectionbackground");(t=t?!(0,s.b0)(this.prevCIdxs)&&e.rowIndex===this.prevCIdxs.rowIndex&&e.cellIndex===this.prevCIdxs.cellIndex&&o:t)?this.successCallBack(i,t,e,l,n)(i):((i={data:n,cellIndex:e,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,cancel:!1}).currentCell=l,i.previousRowCellIndex=this.prevECIdxs,this.parent.trigger(r.hJm,this.fDataUpdate(i),this.successCallBack(i,t,e,l,n)),this.cellselected=!0)}}},e.prototype.successCallBack=function(e,t,i,l,n){var o=this;return function(e){var a="currentCell";if(((0,s.hX)(e)||!0!==e.cancel)&&(t||(e[""+a]=e[""+a]?e[""+a]:l),o.clearCell(),t||o.updateCellSelection(l,i.rowIndex,i.cellIndex),!t)){var h={data:n,cellIndex:i,currentCell:l,selectedRowCellIndex:o.selectedRowCellIndexes,previousRowCell:o.prevECIdxs?o.getCellIndex(o.prevECIdxs.rowIndex,o.prevECIdxs.cellIndex):void 0};h.previousRowCellIndex=o.prevECIdxs,o.updateCellProps(i,i),o.onActionComplete(h,r.sF6)}}},e.prototype.getCellIndex=function(e,t){return this.parent.getCellFromIndex(e,t)},e.prototype.selectCellsByRange=function(e,t){var i,l,o,a=this;if(this.isCellType()){var h=this.parent,c=this.parent.isSpan?(0,n.tA)(this.parent,e.rowIndex,e.cellIndex):h.getCellFromIndex(e.rowIndex,e.cellIndex),d=e,p=t=t||e;this.currentIndex=e.rowIndex;var g=this.getCurrentBatchRecordChanges()[this.currentIndex];if(!(this.isSingleSel()||!this.isCellType()||this.isEditing())){var u={data:g,cellIndex:e,currentCell:c,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};u.previousRowCellIndex=this.prevECIdxs,this.parent.trigger(r.hJm,this.fDataUpdate(u),function(u){if((0,s.hX)(u)||!0!==u.cancel){if(a.clearCell(),e.rowIndex>t.rowIndex){var C=e;e=t,t=C}for(var f=e.rowIndex;f<=t.rowIndex;f++){0>a.selectionSettings.cellSelectionMode.indexOf("Box")?(i=f===e.rowIndex?e.cellIndex:0,l=f===t.rowIndex?t.cellIndex:a.getLastColIndex(f)):(i=e.cellIndex,l=t.cellIndex),o=[];for(var S=i<l?i:l,x=i>l?i:l;S<=x;S++)(c=a.parent.isSpan?(0,n.tA)(h,f,S):h.getCellFromIndex(f,S))&&(o.push(S),a.updateCellSelection(c),a.addAttribute(c));a.selectedRowCellIndexes.push({rowIndex:f,cellIndexes:o})}var m={data:g,cellIndex:p,currentCell:h.getCellFromIndex(p.rowIndex,p.cellIndex),selectedRowCellIndex:a.selectedRowCellIndexes,previousRowCell:a.prevECIdxs?a.getCellIndex(a.prevECIdxs.rowIndex,a.prevECIdxs.cellIndex):void 0};m.previousRowCellIndex=a.prevECIdxs,a.isDragged||(a.onActionComplete(m,r.sF6),a.cellselected=!0),a.updateCellProps(d,p)}})}}},e.prototype.selectCells=function(e){if(this.isCellType()){var t=this.parent,i=t.getCellFromIndex(e[0].rowIndex,e[0].cellIndexes[0]);this.currentIndex=e[0].rowIndex;var s=this.getCurrentBatchRecordChanges()[this.currentIndex];if(!(this.isSingleSel()||!this.isCellType()||this.isEditing())){var l={data:s,cellIndex:e[0].cellIndexes[0],currentCell:i,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};l.previousRowCellIndex=this.prevECIdxs,this.onActionBegin(l,r.hJm);for(var n=0,o=e.length;n<o;n++)for(var a=0,h=e[parseInt(n.toString(),10)].cellIndexes.length;a<h;a++)(i=t.getCellFromIndex(e[parseInt(n.toString(),10)].rowIndex,e[parseInt(n.toString(),10)].cellIndexes[parseInt(a.toString(),10)]))&&(this.updateCellSelection(i),this.addAttribute(i),this.addRowCellIndex({rowIndex:e[parseInt(n.toString(),10)].rowIndex,cellIndex:e[parseInt(n.toString(),10)].cellIndexes[parseInt(a.toString(),10)]}));this.updateCellProps({rowIndex:e[0].rowIndex,cellIndex:e[0].cellIndexes[0]},{rowIndex:e[0].rowIndex,cellIndex:e[0].cellIndexes[0]});var c={data:s,cellIndex:e[0].cellIndexes[0],currentCell:i,selectedRowCellIndex:this.selectedRowCellIndexes,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};c.previousRowCellIndex=this.prevECIdxs,this.onActionComplete(c,r.sF6)}}},e.prototype.addCellsToSelection=function(e){if(!(!this.isCellType()||this.isCellType()&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache))){var t,i,l,n=this.parent;this.currentIndex=e[0].rowIndex;var o=this.getCurrentBatchRecordChanges()[this.currentIndex];if(!(this.isSingleSel()||!this.isCellType()||this.isEditing())){this.hideAutoFill(),l=n.getRowsObject()[e[0].rowIndex],n.groupSettings.columns.length>0&&(l=n.getRowObjectFromUID(this.target.parentElement.getAttribute("data-uid")));for(var a=[],h=0;h<e.length;h++){for(var c=e[h],d=0,p=this.selectedRowCellIndexes.length;d<p;d++)if(this.selectedRowCellIndexes[parseInt(d.toString(),10)].rowIndex===c.rowIndex){i=d;break}t=n.getCellFromIndex(c.rowIndex,this.getColIndex(c.rowIndex,c.cellIndex));var g=c.cellIndex;n.groupSettings.columns.length>0?a.push(l.cells[g+n.groupSettings.columns.length].foreignKeyData):a.push(l.cells[parseInt(g.toString(),10)].foreignKeyData);var u={cancel:!1,data:o,cellIndex:e[0],isShiftPressed:this.isMultiShiftRequest,currentCell:t,isCtrlPressed:this.isMultiCtrlRequest,previousRowCell:this.prevECIdxs?n.getCellFromIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0},C="previousRowCellIndex";u[""+C]=this.prevECIdxs;var f=i>-1;if(f){var S=this.selectedRowCellIndexes[parseInt(i.toString(),10)].cellIndexes;S.indexOf(c.cellIndex)>-1||"Both"===this.selectionSettings.mode&&t.classList.contains("e-gridchkbox")&&!t.getAttribute("aria-selected")?(this.cellDeselect(r.efc,[{rowIndex:c.rowIndex,cellIndexes:[c.cellIndex]}],o,[t],a),S.splice(S.indexOf(c.cellIndex),1),0===S.length&&this.selectedRowCellIndexes.splice(i,1),t.classList.remove("e-cellselectionbackground"),t.removeAttribute("aria-selected"),this.cellDeselect(r.Lcf,[{rowIndex:c.rowIndex,cellIndexes:[c.cellIndex]}],o,[t],a)):(f=!1,this.onActionBegin(u,r.hJm),this.addRowCellIndex({rowIndex:c.rowIndex,cellIndex:c.cellIndex}),this.updateCellSelection(t),this.addAttribute(t))}else{if(this.onActionBegin(u,r.hJm),!(0,s.hX)(u)&&!0===u.cancel)return;this.updateCellSelection(t,c.rowIndex,c.cellIndex)}if(!f){var x={data:o,cellIndex:e[0],currentCell:t,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,selectedRowCellIndex:this.selectedRowCellIndexes};x[""+C]=this.prevECIdxs,this.onActionComplete(x,r.sF6),this.cellselected=!0}this.updateCellProps(c,c)}}}},e.prototype.getColIndex=function(e,t){var i=this.parent.getColumnByIndex(t),s=(0,n.Ax)(this.parent,i,e);if(s){for(var l=0;l<s.length;l++)if(parseInt(s[parseInt(l.toString(),10)].getAttribute(a.Pc),10)===t)return l}return -1},e.prototype.getLastColIndex=function(e){var t=this.parent.getDataRows()[parseInt(e.toString(),10)].querySelectorAll("td.e-rowcell");return parseInt(t[t.length-1].getAttribute(a.Pc),10)},e.prototype.clearCell=function(){this.clearCellSelection()},e.prototype.cellDeselect=function(e,t,i,l,n){if(l&&l.length>0)for(var r=0;r<l.length;r++){var o=l[r];o&&o.classList.contains(a.yM)&&this.updateCheckBoxes((0,s.kp)(o,"tr"))}var h={cells:l,data:i,cellIndexes:t,foreignKeyData:n,cancel:!1};this.parent.trigger(e,h),this.isPreventCellSelect=h.cancel},e.prototype.updateCellSelection=function(e,t,i){(0,s.hX)(t)||this.addRowCellIndex({rowIndex:t,cellIndex:i}),e.classList.add("e-cellselectionbackground"),e.classList.contains(a.yM)&&this.updateCheckBoxes((0,s.kp)(e,"tr"),!0),this.addAttribute(e)},e.prototype.addAttribute=function(e){this.target=e,(0,s.hX)(e)||(e.setAttribute("aria-selected","true"),this.preventFocus||this.focus.onClick({target:e},!0))},e.prototype.updateCellProps=function(e,t){this.prevCIdxs=e,this.prevECIdxs=t,this.isCellSelected=this.selectedRowCellIndexes.length&&!0},e.prototype.addRowCellIndex=function(e){for(var t,i,s=0,l=this.selectedRowCellIndexes.length;s<l;s++)if(this.selectedRowCellIndexes[parseInt(s.toString(),10)].rowIndex===e.rowIndex){t=!0,i=s;break}t?0>this.selectedRowCellIndexes[parseInt(i.toString(),10)].cellIndexes.indexOf(e.cellIndex)&&this.selectedRowCellIndexes[parseInt(i.toString(),10)].cellIndexes.push(e.cellIndex):this.selectedRowCellIndexes.push({rowIndex:e.rowIndex,cellIndexes:[e.cellIndex]})},e.prototype.clearCellSelection=function(){if(this.isCellSelected){var e=this.parent,t=this.getSelectedCellsElement(),i=this.selectedRowCellIndexes,s=[],l=[],n=[],o=this.getCurrentBatchRecordChanges();this.hideAutoFill();for(var a=0,h=i.length;a<h;a++){s.push(o[i[parseInt(a.toString(),10)].rowIndex]);for(var c=this.getRowObj(i[parseInt(a.toString(),10)].rowIndex),d=0,p=i[parseInt(a.toString(),10)].cellIndexes.length;d<p;d++)c.cells&&n.push(c.cells[i[parseInt(a.toString(),10)].cellIndexes[parseInt(d.toString(),10)]].foreignKeyData),l.push(e.getCellFromIndex(i[parseInt(a.toString(),10)].rowIndex,i[parseInt(a.toString(),10)].cellIndexes[parseInt(d.toString(),10)]))}if(this.cellDeselect(r.efc,i,s,l,n),!0!==this.isPreventCellSelect){for(var a=0,h=t.length;a<h;a++)t[parseInt(a.toString(),10)].classList.remove("e-cellselectionbackground"),t[parseInt(a.toString(),10)].removeAttribute("aria-selected");this.bdrElement&&this.showHideBorders("none"),this.selectedRowCellIndexes=[],this.isCellSelected=!1,!this.isDragged&&this.cellselected&&this.cellDeselect(r.Lcf,i,s,l,n)}}},e.prototype.getSelectedCellsElement=function(){for(var e=this.parent.getDataRows(),t=[],i=0,s=e.length;i<s;i++)t=t.concat([].slice.call(e[parseInt(i.toString(),10)].getElementsByClassName("e-cellselectionbackground")));return t},e.prototype.mouseMoveHandler=function(e){e.preventDefault(),this.stopTimer();var t,i=this.parent.element.getBoundingClientRect(),l=this.x,r=this.y,o=(0,n.E9)(e),h=o.x-i.left,c=o.y-i.top,d=(0,s.kp)(e.target,"tr");if(this.isDragged=!0,this.isCellDrag||(d||(d=(0,s.kp)(document.elementFromPoint(this.parent.element.offsetLeft+2,e.clientY),"tr")),l>h&&(t=h,h=l,l=t),r>c&&(t=c,c=r,r=t),this.element.style.left=l+"px",this.element.style.top=r+"px",this.element.style.width=h-l+"px",this.element.style.height=c-r+"px"),d&&!e.ctrlKey&&!e.shiftKey){var p=parseInt(d.getAttribute(a.bB),10);if(this.isCellDrag){var g=(0,n.oC)(e.target,a.Jt);g&&(this.startAFCell=this.startCell,this.endAFCell=(0,n.oC)(e.target,a.Jt),p>-1&&this.selectLikeExcel(e,p,parseInt(g.getAttribute(a.Pc),10)))}else this.hideAutoFill(),this.selectRowsByRange(this.startDIndex,p),this.isRowDragSelected=!0}e.ctrlKey||e.shiftKey||this.parent.enableVirtualization||this.parent.enableInfiniteScrolling||this.parent.enableColumnVirtualization||this.parent.groupSettings.columns.length||!this.isCellDrag||this.updateScrollPosition(e,o,this.parent.getContent())},e.prototype.updateScrollPosition=function(e,t,i){var s=this,l=i.getBoundingClientRect();l.left>=t.x-20-(this.parent.enableRtl&&"auto"!==this.parent.height?(0,n.F_)():0)?this.timer1=window.setInterval(function(){s.setScrollPosition(i.firstElementChild,s.parent.enableRtl?"right":"left",e)},200):l.left+i.clientWidth-20-(this.parent.enableRtl||"auto"===this.parent.height?0:(0,n.F_)())<t.x&&(this.timer1=window.setInterval(function(){s.setScrollPosition(i.firstElementChild,s.parent.enableRtl?"left":"right",e)},200)),l.top>=t.y-.5*this.parent.getRowHeight()?this.timer2=window.setInterval(function(){s.setScrollPosition(i.firstElementChild,"up",e)},200):l.top+i.clientHeight-.5*this.parent.getRowHeight()-(i.firstElementChild.scrollWidth>i.firstElementChild.offsetWidth?(0,n.F_)():0)<=t.y&&(this.timer2=window.setInterval(function(){s.setScrollPosition(i.firstElementChild,"down",e)},200))},e.prototype.stopTimer=function(){this.timer1&&(window.clearInterval(this.timer1),this.timer1=null),this.timer2&&(window.clearInterval(this.timer2),this.timer2=null),this.preventFocus=!1},e.prototype.setScrollPosition=function(e,t,i){var l=-1,n=-1;switch((this.endAFCell||this.prevECIdxs)&&(l=this.endAFCell?parseInt(this.endAFCell.getAttribute("index"),10):this.prevECIdxs.rowIndex,n=this.endAFCell?parseInt(this.endAFCell.getAttribute("data-colindex"),10):this.prevECIdxs.cellIndex),t){case"up":if(i&&(0,s.kp)(i.target,".e-headercontent"))return;this.isAutoFillSel&&this.startAFCell&&this.selectedRowCellIndexes.length&&(1===this.selectedRowCellIndexes.length&&this.startAFCell!==this.startCell||this.selectedRowCellIndexes.length>1&&this.startAFCell.getBoundingClientRect().top>0)&&(l=parseInt(this.startAFCell.getAttribute("index"),10)),l-=1,this.parent.frozenRows&&(l+=this.parent.frozenRows+1),l<1?e.scrollTop=0:e.scrollTop-=this.parent.getRowByIndex(l).offsetHeight;break;case"down":this.isAutoFillSel&&this.startAFCell&&this.startAFCell!==this.startCell&&(l=parseInt(this.startAFCell.getAttribute("index"),10)),l<this.parent.getRows().length-1?(l+=1,this.isAutoFillSel&&this.startAFCell&&this.startAFCell!==this.startCell&&(this.startAFCell=this.parent.getCellFromIndex(l,this.selectedRowCellIndexes[0].cellIndexes[0])),e.scrollTop+=this.parent.getRowByIndex(l).offsetHeight):e.scrollTop=e.scrollHeight;break;case"left":if(n>0&&l>-1){this.isAutoFillSel&&this.startAFCell&&this.selectedRowCellIndexes.length&&(this.selectedRowCellIndexes[0].cellIndexes.length>0&&this.startAFCell!==this.startCell||this.selectedRowCellIndexes[0].cellIndexes.length>1&&(!this.parent.enableRtl&&this.startAFCell.getBoundingClientRect().left>0||this.parent.enableRtl&&this.startAFCell.getBoundingClientRect().left<this.parent.element.offsetWidth))&&(n=parseInt(this.startAFCell.getAttribute("data-colindex"),10));var r=this.findNextCell(e,t,n,l);n=r?parseInt(r.getAttribute("data-colindex"),10):-1,this.parent.enableRtl&&r?n<1?e.scrollLeft=e.scrollWidth:e.scrollLeft+=r.offsetWidth:r&&(n<1?e.scrollLeft=0:e.scrollLeft-=r.offsetWidth)}break;case"right":this.isAutoFillSel&&this.startAFCell&&this.startAFCell!==this.startCell&&(n=parseInt(this.startAFCell.getAttribute("data-colindex"),10));var o=this.parent.getCellFromIndex(l,n),a=this.findNextCell(e,t,n,l);a&&this.isAutoFillSel&&this.startAFCell&&this.startAFCell!==this.startCell&&(this.startAFCell=this.parent.getCellFromIndex(this.selectedRowCellIndexes[0].rowIndex,parseInt(a.getAttribute("data-colindex"),10))),n=a?parseInt(a.getAttribute("data-colindex"),10):-1,this.parent.enableRtl&&a?n<this.parent.columns.length-1?e.scrollLeft-=o.offsetWidth:e.scrollLeft=-e.scrollWidth:a&&(n<this.parent.columns.length-1?e.scrollLeft+=o.offsetWidth:e.scrollLeft=e.scrollWidth),this.isAutoFillSel&&(n===this.parent.columns.length-1||-1===n)&&this.startAFCell&&this.endAFCell&&(this.positionAFBorders(),e.scrollLeft=this.parent.enableRtl?-e.scrollWidth:e.scrollWidth)}if(l>-1&&l<this.parent.getRows().length&&n>-1){var h={target:this.parent.getCellFromIndex(l,n)};if(this.isAutoFillSel&&h.target.classList.contains("e-cellselectionbackground")&&("down"===t&&parseInt(h.target.getAttribute("index"),10)===this.parent.getRows().length-1||"right"===t&&parseInt(h.target.getAttribute("data-colindex"),10)===this.parent.columns.length-1))return;this.endAFCell=h.target,this.preventFocus=!0,this.selectLikeExcel(h,l,n)}},e.prototype.findNextCell=function(e,t,i,s){var l=this.parent.getCellFromIndex(s,"left"===t?i-1:i+1);if(l&&l.classList.contains("e-hide")){var n=l.closest("tr").querySelectorAll(".e-rowcell:not(.e-hide)"),r=Array.from(n).indexOf(l.nextElementSibling);if(!(r>0)||!(r<n.length-1))return e.scrollLeft=0,null;l=n[r+("left"===t?-1:1)]}return l},e.prototype.selectLikeExcel=function(e,t,i){this.isAutoFillSel?(this.showAFBorders(),this.selectLikeAutoFill(e)):(this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:t,cellIndex:i}),this.drawBorders())},e.prototype.setFrozenBorders=function(e,t,i){var s=t.style.borderWidth.toString().split(" "),l=[].slice.call(e.querySelectorAll(".e-cellselectionbackground."+["","e-leftfreeze","e-unfreeze","e-leftfreeze","e-unfreeze","e-rightfreeze","e-rightfreeze"][""+i])).filter(function(e){return""===e.style.display}),r=[].slice.call(e.querySelectorAll(".e-cellselectionbackground.e-fixedfreeze")).filter(function(e){return""===e.style.display}),o=this.parent.enableRtl;if(l.length)for(var a=l[0].getAttribute("index"),h=l[0].getAttribute("data-colindex"),c=l[l.length-1].getAttribute("index"),d=l[l.length-1].getAttribute("data-colindex"),p=0;p<l.length;p++)l[parseInt(p.toString(),10)].getAttribute("index")===a&&(1===s.length||3===s.length&&2===parseInt(s[0],10)||4===s.length&&2===parseInt(s[0],10))&&l[parseInt(p.toString(),10)].classList.add("e-xlsel-top-border"),l[parseInt(p.toString(),10)].getAttribute("data-colindex")===h&&(1===s.length||3===s.length&&2===parseInt(s[1],10)||4===s.length&&(!o&&2===parseInt(s[3],10)||o&&2===parseInt(s[1],10)))&&l[parseInt(p.toString(),10)].classList.add(o?"e-xlsel-right-border":"e-xlsel-left-border"),l[parseInt(p.toString(),10)].getAttribute("index")===c&&(1===s.length||3===s.length&&2===parseInt(s[2],10)||4===s.length&&2===parseInt(s[2],10))&&l[parseInt(p.toString(),10)].classList.add("e-xlsel-bottom-border"),l[parseInt(p.toString(),10)].getAttribute("data-colindex")===d&&(1===s.length||3===s.length&&2===parseInt(s[1],10)||4===s.length&&!o&&2===parseInt(s[1],10)||o&&2===parseInt(s[3],10))&&l[parseInt(p.toString(),10)].classList.add(o?"e-xlsel-left-border":"e-xlsel-right-border");if(r.length)for(var a=r[0].getAttribute("index"),h=r[0].getAttribute("data-colindex"),c=r[r.length-1].getAttribute("index"),d=r[r.length-1].getAttribute("data-colindex"),p=0;p<r.length;p++){var g=r[parseInt(p.toString(),10)].getAttribute("index"),u=r[parseInt(p.toString(),10)].getAttribute("data-colindex");g===a&&(!this.parent.getHeaderContent().querySelector(".e-cellselectionbackground.e-fixedfreeze")&&(0,n.oC)(e,"e-content")||!(0,n.oC)(e,"e-content"))&&r[parseInt(p.toString(),10)].classList.add("e-xlsel-top-border"),g===c&&(!this.parent.getContent().querySelector(".e-cellselectionbackground.e-fixedfreeze")&&(0,n.oC)(e,"e-headercontent")||!(0,n.oC)(e,"e-headercontent"))&&r[parseInt(p.toString(),10)].classList.add("e-xlsel-bottom-border");var C=r[parseInt(p.toString(),10)].parentElement.children[parseInt(u,10)-1];u!==h||C&&(!C||C.classList.contains("e-cellselectionbackground"))||r[parseInt(p.toString(),10)].classList.add(o?"e-xlsel-right-border":"e-xlsel-left-border");var f=r[parseInt(p.toString(),10)].parentElement.children[parseInt(u,10)+1];u!==d||f&&(!f||f.classList.contains("e-cellselectionbackground"))||r[parseInt(p.toString(),10)].classList.add(o?"e-xlsel-left-border":"e-xlsel-right-border")}},e.prototype.refreshFrozenBorders=function(){this.bdrElement&&(this.setFrozenBorders(this.parent.getContentTable(),this.bdrElement,"1"),this.parent.isFrozenGrid()&&this.parent.getFrozenMode()===a.U0&&this.setFrozenBorders(this.parent.getContentTable(),this.frcBdrElement,"5"),this.parent.frozenRows&&(this.setFrozenBorders(this.parent.getHeaderTable(),this.fhBdrElement,"3"),this.parent.isFrozenGrid()&&this.parent.getFrozenMode()===a.U0&&this.setFrozenBorders(this.parent.getHeaderTable(),this.frhBdrElement,"6")))},e.prototype.drawBorders=function(){"BoxWithBorder"===this.selectionSettings.cellSelectionMode&&this.selectedRowCellIndexes.length&&!this.parent.isEdit?(this.parent.element.classList.add("e-enabledboxbdr"),this.bdrElement||this.createBorders(),this.positionBorders(),this.parent.isFrozenGrid()&&(this.showHideBorders("none",!0),this.refreshFrozenBorders())):this.showHideBorders("none")},e.prototype.isLastCell=function(e){var t=[].slice.call(e.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"));return t[t.length-1]===e},e.prototype.isLastRow=function(e){var t=[].slice.call((0,s.kp)(e,a.T_).querySelectorAll(".e-row:not(.e-hiddenrow)"));return e.parentElement===t[t.length-1]},e.prototype.isFirstRow=function(e){var t=[].slice.call((0,s.kp)(e,a.T_).querySelectorAll(".e-row:not(.e-hiddenrow)"));return e.parentElement===t[0]},e.prototype.isFirstCell=function(e){return[].slice.call(e.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"))[0]===e},e.prototype.setBorders=function(e,t,i){var s=[].slice.call(e.getElementsByClassName("e-cellselectionbackground")).filter(function(e){return""===e.style.display});if(s.length&&this.parent.isFrozenGrid()&&(s=[].slice.call(e.querySelectorAll(".e-cellselectionbackground."+["","e-leftfreeze","e-unfreeze","e-leftfreeze","e-unfreeze","e-rightfreeze","e-rightfreeze"][""+i]+":not(.e-hide)")).filter(function(e){return""===e.style.display})),s.length){var l=this.parent.isFrozenGrid(),n=s[0],r=s[s.length-1],o=n.getBoundingClientRect(),h=r.getBoundingClientRect(),c=n.offsetParent.getBoundingClientRect();(n.offsetParent.classList.contains("e-content")||n.offsetParent.classList.contains("e-headercontent"))&&(c=n.offsetParent.querySelector("table").getBoundingClientRect());var d=!l&&this.isLastRow(r)&&("1"===i||"2"===i||"5"===i)?2:0,p=l&&("2"===i||"4"===i)&&this.isFirstCell(n)?1:0,g=("Right"===this.parent.getFrozenMode()&&("1"===i||"3"===i)||this.parent.getFrozenMode()===a.U0&&("5"===i||"6"===i))&&this.isFirstCell(n)?1:0;this.parent.enableRtl?(t.style.right=c.right-o.right-p+"px",t.style.width=o.right-h.left+p+1+"px"):(t.style.left=o.left-c.left-p-g+"px",t.style.width=h.right-o.left+p-g+1+"px"),t.style.top=o.top-c.top-0+"px",t.style.height=h.top-o.top>0?h.top-c.top+h.height+(l?0:1)-(o.top-c.top)-d+0+"px":h.height+0-d+(l?0:1)+"px",this.selectDirection+=i}else t.style.display="none"},e.prototype.positionBorders=function(){this.updateStartEndCells(),this.startCell&&this.bdrElement&&this.selectedRowCellIndexes.length&&(this.selectDirection="",this.showHideBorders(""),this.setBorders(this.parent.getContentTable(),this.bdrElement,"1"),this.parent.isFrozenGrid()&&(this.setBorders(this.parent.getContentTable(),this.mcBdrElement,"2"),this.parent.getFrozenMode()===a.U0&&this.setBorders(this.parent.getContentTable(),this.frcBdrElement,"5")),this.parent.frozenRows&&(this.setBorders(this.parent.getHeaderTable(),this.fhBdrElement,"3"),this.parent.isFrozenGrid()&&(this.setBorders(this.parent.getHeaderTable(),this.mhBdrElement,"4"),this.parent.getFrozenMode()===a.U0&&this.setBorders(this.parent.getHeaderTable(),this.frhBdrElement,"6"))),this.applyBorders(this.selectDirection))},e.prototype.applyBothFrozenBorders=function(e){var t=this.parent.enableRtl;switch(e.length){case 6:this.bdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mcBdrElement.style.borderWidth=this.bottom,this.fhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.mhBdrElement.style.borderWidth=this.top,this.frcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.frhBdrElement.style.borderWidth=t?this.top_left:this.top_right;break;case 4:e.includes("1")&&e.includes("2")&&e.includes("3")&&e.includes("4")&&(this.fhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.mhBdrElement.style.borderWidth=t?this.top_left:this.top_right,this.bdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom),e.includes("2")&&e.includes("4")&&e.includes("5")&&e.includes("6")&&(this.mcBdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.frcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.frhBdrElement.style.borderWidth=t?this.top_left:this.top_right);break;case 3:this.bdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.mcBdrElement.style.borderWidth=this.top_bottom,this.frcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.mhBdrElement.style.borderWidth=this.top_bottom,this.frcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom);break;case 2:e.includes("1")&&(this.mcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=this.top_right_left)),e.includes("2")&&(this.bdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.frcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.parent.frozenRows&&(this.mhBdrElement.style.borderWidth=this.top_right_left)),e.includes("3")&&(this.mhBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.bdrElement.style.borderWidth=this.right_bottom_left),e.includes("4")&&(this.fhBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.frhBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.mcBdrElement.style.borderWidth=this.right_bottom_left),e.includes("5")&&(this.mcBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.parent.frozenRows&&(this.frhBdrElement.style.borderWidth=this.top_right_left)),e.includes("6")&&(this.mhBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.frcBdrElement.style.borderWidth=this.right_bottom_left);break;default:this.bdrElement.style.borderWidth=this.all_border,this.mcBdrElement.style.borderWidth=this.all_border,this.frcBdrElement.style.borderWidth=this.all_border,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=this.all_border,this.mhBdrElement.style.borderWidth=this.all_border,this.frhBdrElement.style.borderWidth=this.all_border)}},e.prototype.applyBorders=function(e){var t=this.parent.enableRtl;if(this.parent.getFrozenMode()===a.U0)this.applyBothFrozenBorders(e);else switch(e.length){case 4:"Right"===this.parent.getFrozenMode()?(this.bdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.mcBdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.fhBdrElement.style.borderWidth=t?this.top_left:this.top_right,this.mhBdrElement.style.borderWidth=t?this.top_right:this.top_left):(this.bdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.fhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.mhBdrElement.style.borderWidth=t?this.top_left:this.top_right);break;case 2:"Right"===this.parent.getFrozenMode()?(this.bdrElement.style.borderWidth=e.includes("2")?t?this.top_bottom_left:this.top_right_bottom:this.right_bottom_left,this.mcBdrElement.style.borderWidth=e.includes("1")?t?this.top_right_bottom:this.top_bottom_left:this.right_bottom_left,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=e.includes("1")?this.top_right_left:t?this.top_bottom_left:this.top_right_bottom,this.mhBdrElement.style.borderWidth=e.includes("2")?this.top_right_left:t?this.top_right_bottom:this.top_bottom_left)):(this.bdrElement.style.borderWidth=e.includes("2")?t?this.top_right_bottom:this.top_bottom_left:this.right_bottom_left,this.parent.isFrozenGrid()&&(this.mcBdrElement.style.borderWidth=e.includes("1")?t?this.top_bottom_left:this.top_right_bottom:this.right_bottom_left),this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=e.includes("1")?this.top_right_left:t?this.top_right_bottom:this.top_bottom_left,this.parent.isFrozenGrid()&&(this.mhBdrElement.style.borderWidth=e.includes("2")?this.top_right_left:t?this.top_bottom_left:this.top_right_bottom)));break;default:this.bdrElement.style.borderWidth=this.all_border,this.parent.isFrozenGrid()&&(this.mcBdrElement.style.borderWidth=this.all_border),this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=this.all_border,this.parent.isFrozenGrid()&&(this.mhBdrElement.style.borderWidth=this.all_border))}},e.prototype.createBorders=function(){!this.bdrElement&&(this.bdrElement=this.parent.getContentTable().parentElement.appendChild((0,s.n)("div",{className:"e-xlsel",id:this.parent.element.id+"_bdr",styles:"width: 2px; border-width: 0;"})),this.parent.isFrozenGrid()&&(this.mcBdrElement=this.parent.getContentTable().parentElement.appendChild((0,s.n)("div",{className:"e-xlsel",id:this.parent.element.id+"_mcbdr",styles:"height: 2px; border-width: 0;"})),this.parent.getFrozenMode()===a.U0&&(this.frcBdrElement=this.parent.getContentTable().parentElement.appendChild((0,s.n)("div",{className:"e-xlsel",id:this.parent.element.id+"_frcbdr",styles:"height: 2px; border-width: 0;"})))),this.parent.frozenRows&&(this.fhBdrElement=this.parent.getHeaderTable().parentElement.appendChild((0,s.n)("div",{className:"e-xlsel",id:this.parent.element.id+"_fhbdr",styles:"height: 2px;"}))),this.parent.frozenRows&&this.parent.isFrozenGrid()&&(this.mhBdrElement=this.parent.getHeaderTable().parentElement.appendChild((0,s.n)("div",{className:"e-xlsel",id:this.parent.element.id+"_mhbdr",styles:"height: 2px;"})),this.parent.getFrozenMode()===a.U0&&(this.frhBdrElement=this.parent.getHeaderTable().parentElement.appendChild((0,s.n)("div",{className:"e-xlsel",id:this.parent.element.id+"_frhbdr",styles:"height: 2px;"})))))},e.prototype.showHideBorders=function(e,t){if(this.bdrElement){if(this.bdrElement.style.display=e,this.parent.isFrozenGrid()){var i=this.parent.getContentTable();(0,s.vy)(i.querySelectorAll(".e-xlsel-top-border"),"e-xlsel-top-border"),(0,s.vy)(i.querySelectorAll(".e-xlsel-left-border"),"e-xlsel-left-border"),(0,s.vy)(i.querySelectorAll(".e-xlsel-right-border"),"e-xlsel-right-border"),(0,s.vy)(i.querySelectorAll(".e-xlsel-bottom-border"),"e-xlsel-bottom-border"),t||(this.mcBdrElement.style.display=e),this.parent.getFrozenMode()===a.U0&&(this.frcBdrElement.style.display=e)}if(this.parent.frozenRows){var i=this.parent.getHeaderTable();(0,s.vy)(i.querySelectorAll(".e-xlsel-top-border"),"e-xlsel-top-border"),(0,s.vy)(i.querySelectorAll(".e-xlsel-left-border"),"e-xlsel-left-border"),(0,s.vy)(i.querySelectorAll(".e-xlsel-right-border"),"e-xlsel-right-border"),(0,s.vy)(i.querySelectorAll(".e-xlsel-bottom-border"),"e-xlsel-bottom-border"),this.fhBdrElement.style.display=e}this.parent.frozenRows&&this.parent.isFrozenGrid()&&(t||(this.mhBdrElement.style.display=e),this.parent.getFrozenMode()===a.U0&&(this.frhBdrElement.style.display=e))}},e.prototype.drawAFBorders=function(){this.bdrAFBottom||this.createAFBorders(),this.positionAFBorders()},e.prototype.positionAFBorders=function(){if(this.startCell&&this.bdrAFLeft){var e=this.startAFCell.getBoundingClientRect(),t=this.endAFCell.getBoundingClientRect(),i=t.top-e.top>0?1:0,s=t.top-e.top>=0&&((0,n.oC)(this.startAFCell,a.S1)||(0,n.oC)(this.startAFCell,"e-frozencontent"))&&this.isFirstRow(this.startAFCell)?1.5:0,l=((0,n.oC)(this.startAFCell,a.S1)||(0,n.oC)(this.startAFCell,a.eW))&&this.isFirstCell(this.startAFCell)?1:0,r=this.isLastRow(this.endAFCell)&&((0,n.oC)(this.endAFCell,a.S1)||(0,n.oC)(this.endAFCell,"e-frozencontent"))?2:0,o=this.startAFCell.offsetParent.getBoundingClientRect(),h=this.parent.element.getBoundingClientRect(),c=this.startAFCell.offsetParent.parentElement.scrollTop,d=this.startAFCell.offsetParent.parentElement.scrollLeft,p=c-this.startAFCell.offsetTop,g=d-this.startAFCell.offsetLeft,u=this.parent.element.clientHeight-(0,n.F_)();this.parent.allowPaging&&(u-=this.parent.element.querySelector(".e-pager").offsetHeight),this.parent.aggregates.length&&(u-=this.parent.getFooterContent().offsetHeight);var C=this.parent.element.clientWidth-("auto"!==this.parent.height?(0,n.F_)():0);p=p>0?Math.floor(p)-1:0,g=g>0?g:0;var f=e.left-h.left;if(this.parent.enableRtl){var S=(0,n.oC)(this.startAFCell,a.S1)||(0,n.oC)(this.startAFCell,a.eW)?e.right-this.startAFCell.offsetParent.parentElement.getBoundingClientRect().width-h.left:0;this.bdrAFLeft.style.right=h.right-t.right-2+t.width+"px",this.bdrAFLeft.style.width=C<=parseInt(this.bdrAFLeft.style.right,10)?"0px":"2px";var x=h.right-e.right-l+S-1;x>0?this.bdrAFRight.style.right=x+"px":this.bdrAFRight.style.right="0px",this.bdrAFTop.style.left=t.left-h.left-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFLeft.style.right,10)-parseInt(this.bdrAFRight.style.right,10)-l+1+"px",0>parseInt(this.bdrAFTop.style.left,10)&&(this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)+"px","auto"!==this.parent.height&&(0,n.F_)()?(this.bdrAFTop.style.left=(0,n.F_)()+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)-(0,n.F_)()+"px"):this.bdrAFTop.style.left="0px")}else if(this.bdrAFLeft.style.left=f-l+g-1+"px",this.bdrAFRight.style.left=t.left-h.left-2+t.width+"px",this.bdrAFRight.style.width=C<=parseInt(this.bdrAFRight.style.left,10)?"0px":"2px",this.bdrAFTop.style.left=f+g-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFRight.style.left,10)-parseInt(this.bdrAFLeft.style.left,10)-l+1+"px",C<=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)){var m=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)-C;this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)-m+"px"}if(this.bdrAFLeft.style.top=e.top-h.top-s+p+"px",this.bdrAFLeft.style.height=t.top-e.top>0?t.top-o.top+t.height+1-(e.top-o.top)+s-r-p+"px":t.height+s-r-p+"px",this.bdrAFRight.style.top=this.bdrAFLeft.style.top,this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px",this.bdrAFTop.style.top=this.bdrAFRight.style.top,this.bdrAFBottom.style.left=this.bdrAFTop.style.left,this.bdrAFBottom.style.top=parseFloat(this.bdrAFLeft.style.top)+parseFloat(this.bdrAFLeft.style.height)-i-1+"px",this.bdrAFBottom.style.width=u<=parseFloat(this.bdrAFBottom.style.top)?"0px":this.bdrAFTop.style.width,u<=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10)){var I=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10)-u;this.bdrAFLeft.style.height=parseInt(this.bdrAFLeft.style.height,10)-I+"px",this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px"}}},e.prototype.createAFBorders=function(){this.bdrAFLeft||(this.bdrAFLeft=this.parent.element.appendChild((0,s.n)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafleft",styles:"width: 2px;"})),this.bdrAFRight=this.parent.element.appendChild((0,s.n)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafright",styles:"width: 2px;"})),this.bdrAFBottom=this.parent.element.appendChild((0,s.n)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafbottom",styles:"height: 2px;"})),this.bdrAFTop=this.parent.element.appendChild((0,s.n)("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdraftop",styles:"height: 2px;"})))},e.prototype.destroyAutoFillElements=function(){this.bdrAFLeft&&(this.bdrAFLeft.remove(),this.bdrAFRight.remove(),this.bdrAFBottom.remove(),this.bdrAFTop.remove(),this.bdrAFLeft=this.bdrAFRight=this.bdrAFBottom=this.bdrAFTop=null),this.autofill&&(this.autofill.remove(),this.autofill=null)},e.prototype.showAFBorders=function(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="",this.bdrAFRight.style.display="",this.bdrAFBottom.style.display="",this.bdrAFTop.style.display="")},e.prototype.hideAFBorders=function(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="none",this.bdrAFRight.style.display="none",this.bdrAFBottom.style.display="none",this.bdrAFTop.style.display="none")},e.prototype.updateValue=function(e,t,i){var s=this.createBeforeAutoFill(e,t,i);if(!s.cancel){var l=this.parent.getColumnByIndex(t);this.parent.editModule&&i&&("number"===l.type?this.parent.editModule.updateCell(e,l.field,parseFloat(s.value)):this.parent.editModule.updateCell(e,l.field,s.value))}},e.prototype.createBeforeAutoFill=function(e,t,i){var s={column:this.parent.getColumnByIndex(t),value:i.innerText};return this.parent.trigger(r.mKl,s),s},e.prototype.getAutoFillCells=function(e,t){return[].slice.call(this.parent.getDataRows()[parseInt(e.toString(),10)].querySelectorAll(".e-cellselectionbackground"))},e.prototype.selectLikeAutoFill=function(e,t){var i=parseInt((0,n.oC)(this.startAFCell,a.nM).getAttribute(a.bB),10),s=parseInt(this.startAFCell.getAttribute(a.Pc),10),l=parseInt((0,n.oC)(this.endAFCell,a.nM).getAttribute(a.bB),10),r=parseInt(this.endAFCell.getAttribute(a.Pc),10),o=this.selectedRowCellIndexes.length-1,h=this.selectedRowCellIndexes[0].cellIndexes.length-1;switch(!0){case!t&&this.endAFCell.classList.contains("e-cellselectionbackground")&&!!(0,n.oC)(e.target,a.Jt):this.startAFCell=this.parent.getCellFromIndex(i,s),this.endAFCell=this.parent.getCellFromIndex(i+o,s+h),this.drawAFBorders();break;case this.autoFillRLselection&&s+h<r&&r-s-h+1>l-i-o&&r-s-h+1>i-l:if(this.endAFCell=this.parent.getCellFromIndex(i+o,r),l=parseInt((0,n.oC)(this.endAFCell,a.nM).getAttribute(a.bB),10),r=parseInt(this.endAFCell.getAttribute(a.Pc),10),t){for(var c=parseInt(this.endCell.getAttribute(a.Pc),10),d=i;d<=l;d++)for(var p=this.getAutoFillCells(d,s),g=0,u=c+1;u<=r;u++)g>h&&(g=0),this.updateValue(d,u,p[parseInt(g.toString(),10)]),g++;this.selectCellsByRange({rowIndex:i,cellIndex:this.startCellIndex},{rowIndex:l,cellIndex:r})}else this.drawAFBorders();break;case this.autoFillRLselection&&s>r&&s-r+1>l-i-o&&s-r+1>i-l:if(this.startAFCell=this.parent.getCellFromIndex(i,r),this.endAFCell=this.endCell,t){for(var d=i;d<=i+o;d++){var p=this.getAutoFillCells(d,s);p.reverse();for(var g=0,u=this.startCellIndex-1;u>=r;u--)g>h&&(g=0),this.updateValue(d,u,p[parseInt(g.toString(),10)]),g++}this.selectCellsByRange({rowIndex:i,cellIndex:r},{rowIndex:i+o,cellIndex:this.startCellIndex+h})}else this.drawAFBorders();break;case i>l:if(this.startAFCell=this.parent.getCellFromIndex(l,s),this.endAFCell=this.endCell,t){for(var C=parseInt(this.endCell.parentElement.getAttribute(a.bB),10),f=C,d=i-1;d>=l;d--){f===this.startIndex-1&&(f=C);var p=this.getAutoFillCells(f,s),g=0;f--;for(var u=this.startCellIndex;u<=this.startCellIndex+h;u++)this.updateValue(d,u,p[parseInt(g.toString(),10)]),g++}this.selectCellsByRange({rowIndex:l,cellIndex:s+h},{rowIndex:i+o,cellIndex:s})}else this.drawAFBorders();break;default:if(this.endAFCell=this.parent.getCellFromIndex(l,s+h),t){for(var C=parseInt(this.endCell.parentElement.getAttribute(a.bB),10),f=this.startIndex,d=C+1;d<=l;d++){f===C+1&&(f=this.startIndex);var p=this.getAutoFillCells(f,s);f++;for(var g=0,S=this.startCellIndex;S<=this.startCellIndex+h;S++)this.updateValue(d,S,p[parseInt(g.toString(),10)]),g++}this.selectCellsByRange({rowIndex:C-o,cellIndex:s},{rowIndex:l,cellIndex:s+h})}else this.drawAFBorders()}},e.prototype.mouseUpHandler=function(e){this.stopTimer(),document.body.classList.remove("e-disableuserselect"),this.element&&!(0,s.hX)(this.element.parentElement)&&(0,s.TF)(this.element),this.isDragged&&1===this.selectedRowCellIndexes.length&&1===this.selectedRowCellIndexes[0].cellIndexes.length?this.mUPTarget=(0,n.oC)(e.target,a.Jt):this.mUPTarget=null;var t=(0,s.kp)(e.target,".e-rowcell");if(this.isDragged&&!this.isAutoFillSel&&"Cell"===this.selectionSettings.mode&&t&&t.classList.contains(a.Jt)){var i=parseInt(t.parentElement.getAttribute(a.bB),10),l=parseInt(t.getAttribute(a.Pc),10);this.isDragged=!1,this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:i,cellIndex:l})}if(this.isDragged=!1,this.updateAutoFillPosition(),this.isAutoFillSel){this.preventFocus=!0;var o=(0,n.oC)(e.target,a.Jt);this.endAFCell=o||(this.endCell===this.endAFCell?this.startAFCell:this.endAFCell),this.startAFCell=this.startCell,(0,s.hX)(this.endAFCell)||(0,s.hX)(this.startAFCell)||(this.updateStartCellsIndex(),this.selectLikeAutoFill(e,!0),this.updateAutoFillPosition(),this.hideAFBorders(),this.positionBorders(),this.parent.isFrozenGrid()&&(this.showHideBorders("none",!0),this.refreshFrozenBorders()),this.parent.aggregates.length>0&&this.parent.notify(r.whj,{})),this.isAutoFillSel=!1,this.preventFocus=!1}s.Jm.remove(this.parent.getContent(),"mousemove",this.mouseMoveHandler),this.parent.frozenRows&&s.Jm.remove(this.parent.getHeaderContent(),"mousemove",this.mouseMoveHandler),s.Jm.remove(document,"mouseup",this.mouseUpHandler)},e.prototype.hideAutoFill=function(){this.autofill&&(this.autofill.style.display="none")},e.prototype.updateAutoFillPosition=function(){if(this.parent.enableAutoFill&&!this.parent.isEdit&&this.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel()&&this.selectedRowCellIndexes.length){var e=parseInt(this.target.getAttribute(a.Pc),10),t=parseInt(this.target.getAttribute("index"),10),i=this.selectedRowCellIndexes[this.selectedRowCellIndexes.length-1].rowIndex,l=this.getAutoFillCells(i,e).filter(function(e){return""===e.style.display}),r=this.parent.getColumnByIndex(e),o=(r.getFreezeTableName(),t<this.parent.frozenRows),h=this.parent.getFrozenMode()===a.U0&&r.getFreezeTableName()===a.Xg;!(0,s.Lt)("#"+this.parent.element.id+"_autofill",(0,n.oC)(this.target,a.tp))&&((0,s.Lt)("#"+this.parent.element.id+"_autofill",this.parent.element)&&(0,s.Lt)("#"+this.parent.element.id+"_autofill",this.parent.element).remove(),this.autofill=(0,s.n)("div",{className:"e-autofill",id:this.parent.element.id+"_autofill"}),this.autofill.style.display="none",(this.target.classList.contains("e-leftfreeze")||this.target.classList.contains("e-rightfreeze")||this.target.classList.contains("e-fixedfreeze"))&&this.autofill.classList.add("e-freeze-autofill"),o?this.parent.getHeaderTable().parentElement.appendChild(this.autofill):this.parent.getContentTable().parentElement.appendChild(this.autofill),h&&(o?this.parent.getHeaderTable().parentElement.appendChild(this.autofill):this.parent.getContentTable().parentElement.appendChild(this.autofill)));var c=l[l.length-1];if(c&&c.offsetParent){var d=c.getBoundingClientRect(),p=c.offsetParent.getBoundingClientRect();(c.offsetParent.classList.contains("e-content")||c.offsetParent.classList.contains("e-headercontent"))&&(p=c.offsetParent.querySelector("table").getBoundingClientRect());var g=this.isLastCell(c)?4:0,u=this.isLastRow(c)?3:0;this.parent.enableRtl?this.autofill.style.right=p.right-d.right+d.width-4-g+"px":this.autofill.style.left=d.left-p.left+d.width-4-g+"px",this.autofill.style.top=d.top-p.top+d.height-5-u+"px"}this.autofill.style.display=""}else this.hideAutoFill()},e.prototype.mouseDownHandler=function(e){this.mouseButton=e.button;var t,i=e.target,l=this.parent,r=(0,n.oC)(i,"e-grid");if(!(r&&r.id!==l.element.id||(0,n.oC)(i,a.VW)&&!this.parent.frozenRows||(0,n.oC)(i,"e-editedbatchcell")||(0,n.oC)(i,a.QF))){if((e.shiftKey||e.ctrlKey)&&e.preventDefault(),(0,n.oC)(i,a.Jt)&&!e.shiftKey&&!e.ctrlKey){if(!(l.selectionSettings.cellSelectionMode.indexOf("Box")>-1)||this.isRowType()||this.isSingleSel()){if(l.allowRowDragAndDrop&&!l.isEdit&&!this.parent.selectionSettings.checkboxOnly){if(this.isRowDragSelected=!1,!this.isRowType()||this.isSingleSel()||(0,s.kp)(i,"td").classList.contains("e-selectionbackground")){this.isDragged=!1;return}t=!0,this.element=this.parent.createElement("div",{className:"e-griddragarea"}),l.getContent().appendChild(this.element)}}else this.isCellDrag=!0,t=!0;t&&this.enableDrag(e,!0)}this.updateStartEndCells(),(i.classList.contains("e-autofill")||i.classList.contains("e-xlsel"))&&(this.isCellDrag=!0,this.isAutoFillSel=!0,this.enableDrag(e))}},e.prototype.updateStartEndCells=function(){var e=[].slice.call(this.parent.element.getElementsByClassName("e-cellselectionbackground"));this.startCell=e[0],this.endCell=e[e.length-1],this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute(a.bB),10),this.startCellIndex=parseInt((0,n.oC)(this.startCell,a.Jt).getAttribute(a.Pc),10))},e.prototype.updateStartCellsIndex=function(){this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute(a.bB),10),this.startCellIndex=parseInt((0,n.oC)(this.startCell,a.Jt).getAttribute(a.Pc),10))},e.prototype.enableDrag=function(e,t){var i=this.parent;if(t){var l=(0,s.kp)(e.target,"tr");this.startDIndex=parseInt(l.getAttribute(a.bB),10),this.startDCellIndex=parseInt((0,n.oC)(e.target,a.Jt).getAttribute(a.Pc),10)}document.body.classList.add("e-disableuserselect");var r=i.element.getBoundingClientRect(),o=(0,n.E9)(e);this.x=o.x-r.left,this.y=o.y-r.top,s.Jm.add(i.getContent(),"mousemove",this.mouseMoveHandler,this),this.parent.frozenRows&&s.Jm.add(i.getHeaderContent(),"mousemove",this.mouseMoveHandler,this),s.Jm.add(document,"mouseup",this.mouseUpHandler,this)},e.prototype.clearSelAfterRefresh=function(e){var t=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.requestType;if("virtualscroll"===e.requestType||this.parent.isPersistSelection||t||this.clearSelection(),("virtualscroll"===e.requestType||t)&&this.parent.isPersistSelection&&this.isPartialSelection&&this.isHdrSelectAllClicked){var i=this.parent.getRowsObject().filter(function(e){return e.isSelectable}),s=[];this.selectedRowState={},this.persistSelectedData=[];for(var l=0;l<i.length;l++){s.push(i[parseInt(l.toString(),10)].index);var n=this.getPkValue(this.primaryKey,i[parseInt(l.toString(),10)].data);this.selectedRowState[""+n]=!0,this.persistSelectedData.push(i[parseInt(l.toString(),10)].data)}this.selectedRowIndexes=s}},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:r.yPb,handler:this.enableAfterRender},{event:r.qOR,handler:this.initializeSelection},{event:r.m0l,handler:this.onActionComplete},{event:r.kYU,handler:this.onActionComplete},{event:r.$HR,handler:this.onPropertyChanged},{event:r.uJh,handler:this.onCellFocused},{event:r.IcQ,handler:this.clearSelAfterRefresh},{event:r.QzQ,handler:this.columnPositionChanged},{event:r.PRb,handler:this.initialEnd},{event:r.Osn,handler:this.rowsRemoved},{event:r.CRr,handler:this.refreshHeader},{event:r.CZS,handler:this.destroyAutoFillElements},{event:r.zrj,handler:this.destroy}],(0,n.yc)(this.parent,this.evtHandlers,!0,this),this.actionBeginFunction=this.actionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(r.eYd,this.actionBeginFunction),this.parent.addEventListener(r.wn6,this.actionCompleteFunction),this.addEventListener_checkbox())},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(s.Jm.remove(document,"mouseup",this.mouseUpHandler),s.Jm.remove(this.parent.getContent(),"mousedown",this.mouseDownHandler),s.Jm.remove(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler),(0,n.yc)(this.parent,this.evtHandlers,!1),this.parent.removeEventListener(r.eYd,this.actionBeginFunction),this.parent.removeEventListener(r.wn6,this.actionCompleteFunction),this.removeEventListener_checkbox(),this.parent.off(r.CZS,this.destroyAutoFillElements))},e.prototype.wireEvents=function(){this.isMacOS=-1!==navigator.userAgent.indexOf("Mac OS"),this.isMacOS?(s.Jm.add(this.parent.element,"keydown",this.keyDownHandler,this),s.Jm.add(this.parent.element,"keyup",this.keyUpHandler,this)):this.parent.allowKeyboard||s.Jm.add(this.parent.element,"keydown",this.keyDownHandler,this)},e.prototype.unWireEvents=function(){this.isMacOS?(s.Jm.remove(this.parent.element,"keydown",this.keyDownHandler),s.Jm.remove(this.parent.element,"keyup",this.keyUpHandler)):this.parent.allowKeyboard||s.Jm.remove(this.parent.element,"keydown",this.keyDownHandler)},e.prototype.columnPositionChanged=function(){this.parent.isPersistSelection||this.clearSelection()},e.prototype.refreshHeader=function(){this.setCheckAllState()},e.prototype.rowsRemoved=function(e){for(var t=0;t<e.records.length;t++){var i=this.getPkValue(this.primaryKey,e.records[parseInt(t.toString(),10)]);delete this.selectedRowState[""+i],--this.totalRecordsCount}this.setCheckAllState()},e.prototype.beforeFragAppend=function(e){"virtualscroll"===e.requestType||this.parent.isPersistSelection||this.clearSelection()},e.prototype.getCheckAllBox=function(){return this.parent.getHeaderContent().querySelector(".e-checkselectall")},e.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&(this.render(),this.initPerisistSelection())},e.prototype.render=function(e){s.Jm.add(this.parent.getContent(),"mousedown",this.mouseDownHandler,this),s.Jm.add(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler,this)},e.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName()){var t=this.parent;(0,s.hX)(e.properties.type)||("Single"===this.selectionSettings.type?(t.element.removeAttribute("aria-multiselectable"),this.selectedRowCellIndexes.length>1&&(this.clearCellSelection(),this.prevCIdxs=void 0),this.selectedRowIndexes.length>1&&(this.clearRowSelection(),this.prevRowIndex=void 0),this.selectedColumnsIndexes.length>1&&(this.clearColumnSelection(),this.prevColIndex=void 0),this.enableSelectMultiTouch=!1,this.hidePopUp()):"Multiple"===this.selectionSettings.type&&t.element.setAttribute("aria-multiselectable","true")),(0,s.hX)(e.properties.mode)&&(0,s.hX)(e.properties.cellSelectionMode)||(this.clearSelection(),this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevColIndex=void 0),this.isPersisted=!0,this.checkBoxSelectionChanged(),this.isPersisted=!1,this.parent.isCheckBoxSelection||this.initPerisistSelection(),this.parent.getColumns().filter(function(e){return"checkbox"===e.type}).length&&(t.isCheckBoxSelection="ResetOnRowClick"!==this.selectionSettings.checkboxMode),this.drawBorders()}},e.prototype.hidePopUp=function(){this.parent.element.querySelector(".e-gridpopup").getElementsByClassName("e-rowselect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none")},e.prototype.initialEnd=function(){this.selectedRowIndexes.length||(this.parent.off(r.PRb,this.initialEnd),this.selectRow(this.parent.selectedRowIndex))},e.prototype.checkBoxSelectionChanged=function(){var e=this.parent;e.off(r.PRb,this.checkBoxSelectionChanged);var t=e.getColumns().filter(function(e){return"checkbox"===e.type});t.length>0&&(e.isCheckBoxSelection=!0,this.chkField=t[0].field,this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount,(0,s.hX)(this.totalRecordsCount)&&(this.totalRecordsCount=this.getCurrentBatchRecordChanges().length),this.isSingleSel()?(e.selectionSettings.type="Multiple",e.dataBind()):this.initPerisistSelection()),e.isCheckBoxSelection||this.isPersisted||(this.chkField=null,this.initPerisistSelection())},e.prototype.initPerisistSelection=function(){var e=this.parent;this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0?(e.isPersistSelection=!0,this.ensureCheckboxFieldSelection()):this.parent.getPrimaryKeyFieldNames().length>0?(e.isPersistSelection=!1,this.ensureCheckboxFieldSelection()):(e.isPersistSelection=!1,this.selectedRowState={})},e.prototype.ensureCheckboxFieldSelection=function(){var e=this.parent;this.primaryKey=this.parent.getPrimaryKeyFieldNames()[0],!e.enableVirtualization&&this.chkField&&(e.isPersistSelection&&0===Object.keys(this.selectedRowState).length||!e.isPersistSelection)&&this.dataSuccess(!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result||this.parent.getDataModule().isRemote()?this.parent.getCurrentViewRecords():this.parent.renderModule.data.dataManager.dataSource.json)},e.prototype.dataSuccess=function(e){for(var t=0;t<e.length;t++){var i=this.getPkValue(this.primaryKey,e[parseInt(t.toString(),10)]),l=e[parseInt(t.toString(),10)][this.chkField];(0,s.hX)(this.selectedRowState[""+i])&&l&&"boolean"==typeof l&&(this.selectedRowState[""+i]=l,this.parent.isPersistSelection&&this.persistSelectedData.push(e[parseInt(t.toString(),10)]))}},e.prototype.setRowSelection=function(e){if(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result){if(e){var t=Object.keys(this.selectedRowState),i=Object.keys(this.unSelectedRowState);if(!this.isCheckboxReset)for(var l=this.parent.groupSettings.columns.length&&this.parent.isPersistSelection?this.parent.currentViewData.records:this.parent.currentViewData,n=0;n<l.length;n++){var r=l[n];if(!(0,s.hX)(r[this.primaryKey])){var o=r[this.primaryKey].toString();-1===t.indexOf(o)&&-1===i.indexOf(o)&&(this.selectedRowState[r[this.primaryKey]]=!0)}}}else this.selectedRowState={},this.unSelectedRowState={},this.rmtHdrChkbxClicked=!1}else if(e){if(this.isPartialSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling))for(var a=this.parent.getRowsObject().filter(function(e){return e.isSelectable}),h=0;h<a.length;h++){var c=a[h];this.selectedRowState[this.getPkValue(this.primaryKey,c.data)]=!0}else{var d=this.isPartialSelection?this.parent.partialSelectedRecords:this.getData();if(this.parent.groupSettings.columns.length)for(var p=0,g=this.isPartialSelection?d:d.records;p<g.length;p++){var r=g[p];this.selectedRowState[this.getPkValue(this.primaryKey,r)]=!0}else for(var u=0;u<d.length;u++){var r=d[u];this.selectedRowState[this.getPkValue(this.primaryKey,r)]=!0}}}else this.selectedRowState={}},e.prototype.getData=function(){return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(!0))},e.prototype.getAvailableSelectedData=function(){var e=new l.M(this.persistSelectedData).executeLocal(this.parent.getDataModule().generateQuery(!0));return this.parent.groupSettings.columns.length&&e&&e.records&&(e=e.records.slice()),e},e.prototype.refreshPersistSelection=function(){var e=this.parent.getRows();if(this.totalRecordsCount=this.parent.getCurrentViewRecords().length,this.parent.allowPaging&&(this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount),!(0,s.hX)(e)&&e.length>0&&(this.parent.isPersistSelection||this.chkField)){for(var t=[],i=0;i<e.length;i++){var l=this.getRowObj(e[parseInt(i.toString(),10)]),r=l&&l.data?this.getPkValue(this.primaryKey,l.data):null;if(null===r)return;if(!this.isPartialSelection||l.isSelectable){var o=void 0,h=e[parseInt(i.toString(),10)].querySelector(".e-checkselect");this.selectedRowState[""+r]||"Check"===this.parent.checkAllRows&&this.selectedRowState[""+r]&&this.totalRecordsCount===Object.keys(this.selectedRowState).length&&0>this.chkAllCollec.indexOf(r)||"Uncheck"===this.parent.checkAllRows&&this.chkAllCollec.indexOf(r)>0&&!this.parent.selectedRowIndex||"Intermediate"===this.parent.checkAllRows&&!(0,s.hX)(this.chkField)&&l.data[this.chkField]?(t.push(parseInt(e[parseInt(i.toString(),10)].getAttribute(a.bB),10)),o=!0):(o=!1,this.checkedTarget!==h&&this.parent.isCheckBoxSelection&&h&&(0,n.Cd)(h.nextElementSibling,o)),this.updatePersistCollection(e[parseInt(i.toString(),10)],o)}}this.isSingleSel()&&t.length>0?this.selectRow(t[0],!0):this.selectRows(t)}(this.parent.isCheckBoxSelection||"ResetOnRowClick"===this.parent.selectionSettings.checkboxMode)&&this.getCurrentBatchRecordChanges().length>0&&this.setCheckAllState()},e.prototype.actionBegin=function(e){if("save"===e.requestType&&this.parent.isPersistSelection){var t=this.parent.element.querySelector(".e-edit-checkselect");if(!(0,s.hX)(t)){var i=(0,s.kp)(t,"."+a.QF);if(i){"Dialog"===this.parent.editSettings.mode&&(i=this.parent.element.querySelector(".e-dlgeditrow"));var l=this.getRowObj(i);if(!l)return;this.selectedRowState[this.getPkValue(this.primaryKey,l.data)]=l.isSelected=t.checked}else this.isCheckedOnAdd=t.checked}}this.parent.isPersistSelection&&this.isPartialSelection&&("paging"===e.requestType&&(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)&&(this.selectedRowIndexes=[]),("filtering"===e.requestType||"searching"===e.requestType)&&(this.parent.partialSelectedRecords=[],this.parent.disableSelectedRecords=[]))},e.prototype.actionComplete=function(e){if("save"===e.requestType&&this.parent.isPersistSelection){if("add"===e.action){if(this.isCheckedOnAdd){var t=this.parent.getRowObjectFromUID(this.parent.getRows()[e.selectedRow].getAttribute("data-uid"));this.selectedRowState[this.getPkValue(this.primaryKey,t.data)]=t.isSelected=this.isCheckedOnAdd}this.isHdrSelectAllClicked=!1,this.setCheckAllState()}this.refreshPersistSelection()}if("delete"===e.requestType&&this.parent.isPersistSelection){for(var i=e.data.slice(),l=0;l<i.length;l++){var n=this.getPkValue(this.primaryKey,i[parseInt(l.toString(),10)]);(0,s.hX)(n)||this.updatePersistDelete(n,this.isPartialSelection)}this.isHdrSelectAllClicked=!1,this.setCheckAllState(),this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount}if("paging"===e.requestType){if(this.parent.isPersistSelection&&this.isPartialSelection&&this.isHdrSelectAllClicked){for(var r=this.parent.getRowsObject(),o=[],l=0;l<r.length;l++)r[parseInt(l.toString(),10)].isSelectable&&o.push(r[parseInt(l.toString(),10)].index);o.length&&this.selectRows(o)}this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevECIdxs=void 0}},e.prototype.onDataBound=function(){if(!this.parent.enableVirtualization&&this.parent.isPersistSelection&&this.selectedRecords.length&&(this.isPrevRowSelection=!0),(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)&&this.rmtHdrChkbxClicked&&("Intermediate"===this.parent.checkAllRows?this.setRowSelection(!0):"Uncheck"===this.parent.checkAllRows&&this.setRowSelection(!1)),this.parent.enableVirtualization&&this.setCheckAllState(),this.parent.isPersistSelection&&this.refreshPersistSelection(),this.initialRowSelection=!!(this.isRowType()&&this.parent.element.querySelectorAll(".e-selectionbackground"))&&!!this.parent.getSelectedRows().length,this.parent.isCheckBoxSelection&&!this.initialRowSelection){for(var e=this.parent.getRowsObject(),t=[],i=0;i<e.length;i++)e[parseInt(i.toString(),10)].isSelected&&t.push(i);t.length&&this.selectRows(t),this.initialRowSelection=!0}},e.prototype.updatePersistSelectedData=function(e){if(this.parent.isPersistSelection){for(var t=this.parent.getRows(),i=0;i<t.length;i++)this.updatePersistCollection(t[parseInt(i.toString(),10)],e);"Uncheck"===this.parent.checkAllRows?(this.setRowSelection(!1),this.persistSelectedData=this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result?this.persistSelectedData:[]):"Check"===this.parent.checkAllRows&&(this.setRowSelection(!0),this.persistSelectedData=this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result||this.isPartialSelection?this.persistSelectedData:this.parent.groupSettings.columns.length?this.getData().records.slice():this.getData().slice())}},e.prototype.checkSelectAllAction=function(e){var t=this.getRenderer(),i=this.parent.element.querySelector(".e-gridform");if(this.checkedTarget=this.getCheckAllBox(),e&&this.getCurrentBatchRecordChanges().length?(this.parent.checkAllRows="Check",this.updatePersistSelectedData(e),this.selectRowsByRange(t.getVirtualRowIndex(0),t.getVirtualRowIndex(this.getCurrentBatchRecordChanges().length-1))):(this.parent.checkAllRows="Uncheck",this.updatePersistSelectedData(e),this.clearSelection()),this.chkAllCollec=[],!(0,s.hX)(i)){var l=i.querySelector(".e-edit-checkselect");(0,s.hX)(l)||(0,n.Cd)(l.nextElementSibling,e)}},e.prototype.checkSelectAll=function(e){var t=this,i=this.getCheckAllStatus(e),l="Check"===i;if(this.isHeaderCheckboxClicked=!0,(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)&&("Uncheck"===i||this.isCheckboxReset||"Intermediate"===i&&this.parent.isPersistSelection)?this.rmtHdrChkbxClicked=!0:this.rmtHdrChkbxClicked=!1,this.rmtHdrChkbxClicked&&this.isCheckboxReset&&(this.unSelectedRowState={}),this.isCheckboxReset=!1,"Intermediate"===i&&(this.chkField||this.parent.isPersistSelection||(l=this.getCurrentBatchRecordChanges().some(function(e){return t.getPkValue(t.primaryKey,e)in t.selectedRowState})),(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)&&this.parent.isPersistSelection)){for(var n=0;n<this.getCurrentBatchRecordChanges().length;n++)if(!(0,s.hX)(this.getPkValue(this.primaryKey,this.getCurrentBatchRecordChanges()[""+n]))){if(Object.keys(this.selectedRowState).includes(this.getPkValue(this.primaryKey,this.getCurrentBatchRecordChanges()[""+n]).toString()))l=!0;else{l=!1;break}}}this.parent.isPersistSelection&&this.parent.allowPaging&&(this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount),this.checkSelectAllAction(!l),this.target=null,this.getCurrentBatchRecordChanges().length>0&&(this.setCheckAllState(),this.updateSelectedRowIndexes()),this.triggerChkChangeEvent(e,!l)},e.prototype.getCheckAllStatus=function(e){(0,s.hX)(e)?(0,s.hX)(this.getCheckAllBox())||(t=this.getCheckAllBox().nextElementSibling.classList):t=e.nextElementSibling.classList;var t,i="None";return t instanceof DOMTokenList&&(t.contains("e-check")?i="Check":t.contains("e-uncheck")?i="Uncheck":t.contains("e-stop")&&(i="Intermediate")),i},e.prototype.checkSelect=function(e){var t=(0,s.kp)(this.checkedTarget,"."+a.Jt),i=this.parent;this.isMultiCtrlRequest=!0;var l=0;if(this.isHeaderCheckboxClicked=!1,(0,n.Gj)(i)){var r=t.parentElement.getAttribute("data-uid");l=this.parent.enableVirtualization&&this.parent.groupSettings.columns.length?parseInt(t.parentElement.getAttribute(a.bB),10):i.getRows().map(function(e){return e.getAttribute("data-uid")}).indexOf(r)}else l=parseInt(t.parentElement.getAttribute(a.bB),10);this.parent.isPersistSelection&&this.parent.element.getElementsByClassName(a.jm).length>0&&"Top"===this.parent.editSettings.newRowPosition&&!this.parent.editSettings.showAddNewRow&&++l,this.rowCellSelectionHandler(l,parseInt(t.getAttribute(a.Pc),10)),this.moveIntoUncheckCollection((0,s.kp)(t,"."+a.nM)),this.setCheckAllState(),this.isMultiCtrlRequest=!1,this.triggerChkChangeEvent(e,e.nextElementSibling.classList.contains("e-check"))},e.prototype.moveIntoUncheckCollection=function(e){if("Check"===this.parent.checkAllRows||"Uncheck"===this.parent.checkAllRows){var t=this.getRowObj(e),i=t&&t.data?this.getPkValue(this.primaryKey,t.data):null;i&&(0>this.chkAllCollec.indexOf(i)?this.chkAllCollec.push(i):this.chkAllCollec.splice(this.chkAllCollec.indexOf(i),1))}},e.prototype.triggerChkChangeEvent=function(e,t){this.parent.trigger(r.OK6,{checked:t,selectedRowIndexes:this.parent.getSelectedRowIndexes(),target:e}),this.parent.isEdit||(this.checkedTarget=null)},e.prototype.updateSelectedRowIndexes=function(){if(this.parent.isCheckBoxSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&this.isPartialSelection&&!(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)&&this.parent.selectionSettings.persistSelection&&"Uncheck"!==this.parent.checkAllRows)for(var e=this.parent.getRowsObject().filter(function(e){return e.isSelectable}),t=0,i=e;t<i.length;t++){var l=i[t];this.selectedRowIndexes.push(l.index)}if(this.parent.isCheckBoxSelection&&this.parent.enableVirtualization&&!this.isPartialSelection&&(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)&&!this.parent.isPersistSelection&&"Check"===this.parent.checkAllRows){var e=this.parent.getRowsObject().filter(function(e){return e.isSelectable});if(e.length!==this.selectedRowIndexes.length)for(var n=0,r=e;n<r.length;n++){var l=r[n];-1>=this.selectedRowIndexes.indexOf(l.index)&&this.selectedRowIndexes.push(l.index)}}},e.prototype.updateSelectedRowIndex=function(e){if(this.parent.isCheckBoxSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&!(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)&&!this.isPartialSelection){if("Check"===this.parent.checkAllRows){this.selectedRowIndexes=[];for(var t=this.parent.groupSettings.columns.length?this.getData().records.length:this.getData().length,i=0;i<t;i++)this.selectedRowIndexes.push(i)}else if("Uncheck"===this.parent.checkAllRows)this.selectedRowIndexes=[];else{var l=this.parent.getRowByIndex(e);if(e&&l&&"false"===l.getAttribute("aria-selected")){var n=this.selectedRowIndexes.indexOf(e);this.selectedRowIndexes.splice(n,1)}}}},e.prototype.isAllSelected=function(e){if(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)return this.getAvailableSelectedData().length===(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling?this.parent.totalDataRecordsCount:this.totalRecordsCount);if(this.isPartialSelection){if(!this.parent.allowPaging||!(this.parent.pageSettings.pageSize<this.parent.pageSettings.totalRecordsCount))return this.isSelectAllRowCount(e);for(var t=this.parent.partialSelectedRecords,i=0;i<t.length;i++){var l=this.getPkValue(this.primaryKey,t[parseInt(i.toString(),10)]);if(!this.selectedRowState[""+l])return!1}return!0}var t=this.getData();this.parent.groupSettings.columns.length&&t.records&&(t=t.records);for(var i=0;i<t.length;i++){var l=this.getPkValue(this.primaryKey,t[parseInt(i.toString(),10)]);if(!this.selectedRowState[""+l])return!1}return!0},e.prototype.someDataSelected=function(){if((this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)&&(this.parent.searchSettings.key.length||this.parent.filterSettings.columns.length))for(var e=this.getAvailableSelectedData(),t=0;t<e.length;t++){var i=this.getPkValue(this.primaryKey,e[parseInt(t.toString(),10)]);if(this.selectedRowState[""+i])return!1}for(var l=this.isPartialSelection?this.parent.partialSelectedRecords:this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result?[]:this.getData(),t=0;t<l.length;t++){var i=this.getPkValue(this.primaryKey,l[parseInt(t.toString(),10)]);if(this.selectedRowState[""+i])return!1}return!0},e.prototype.setCheckAllState=function(e,t){if(this.parent.isCheckBoxSelection||"ResetOnRowClick"===this.parent.selectionSettings.checkboxMode){var i=!1,l=!1,r=Object.keys(this.selectedRowState).length;this.parent.isPersistSelection||(r=this.selectedRowIndexes.length,this.totalRecordsCount=this.getCurrentBatchRecordChanges().length),this.parent.isPersistSelection&&!((this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)&&this.isPartialSelection)&&(this.parent.searchSettings.key.length||this.parent.filterSettings.columns.length)&&(l=!0,i=this.isAllSelected(r));var o=this.getCheckAllBox();if(o){var a=o.nextElementSibling;(0,s.vy)([a],["e-check","e-stop","e-uncheck"]),(0,n.Go)(o,!1),o.indeterminate=!1;var h=this.parent.getDataModule().isRemote()?[]:this.getData();this.parent.groupSettings.columns.length&&h.records&&(h=h.records),i&&l&&(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result||h.length)||!l&&(r===this.totalRecordsCount&&this.totalRecordsCount&&!this.isPartialSelection&&(!(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)||this.parent.allowPaging)||!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling&&this.isPartialSelection&&(this.isSelectAllRowCount(r)||this.isHdrSelectAllClicked)||(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&!this.parent.allowPaging&&(!(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)&&h.length&&r===h.length||(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)&&!this.isPartialSelection&&(r===this.parent.totalDataRecordsCount||(this.isSelectAllRowCount(r)||r===this.totalRecordsCount)&&!this.parent.isPersistSelection)||this.isPartialSelection&&(this.isHdrSelectAllClicked||this.isSelectAllRowCount(r)))||r===this.totalRecordsCount&&this.totalRecordsCount&&!this.isPartialSelection&&!this.parent.allowPaging&&!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling)?((0,s.iQ)([a],["e-check"]),(0,n.Go)(o,!0),t&&this.getRenderer().setSelection(null,!0,!0),this.parent.checkAllRows="Check"):(!this.selectedRowIndexes.length&&(!this.parent.enableVirtualization||!this.persistSelectedData.length&&!l||l&&this.someDataSelected())||0===r&&0===this.getCurrentBatchRecordChanges().length)&&!this.parent.allowPaging||this.parent.allowPaging&&(0===r||r&&l&&this.someDataSelected())?((0,s.iQ)([a],["e-uncheck"]),t&&this.getRenderer().setSelection(null,!1,!0),this.parent.checkAllRows="Uncheck"):((0,s.iQ)([a],["e-stop"]),this.parent.checkAllRows="Intermediate",o.indeterminate=!0),0===r&&0===this.getCurrentBatchRecordChanges().length?(0,s.iQ)([a.parentElement],["e-checkbox-disabled"]):(0,s.vy)([a.parentElement],["e-checkbox-disabled"]),this.isPartialSelection&&(0===this.parent.getRowsObject().filter(function(e){return e.isSelectable}).length&&a.parentElement.querySelector(".e-frame").classList.contains("e-uncheck")?(0,s.iQ)([a.parentElement],["e-checkbox-disabled"]):(0,s.vy)([a.parentElement],["e-checkbox-disabled"])),(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&!this.parent.allowPaging&&!(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result)&&this.updateSelectedRowIndex(e)}}},e.prototype.isSelectAllRowCount=function(e){var t=0,i=this.parent.getRowsObject();return this.parent.selectionSettings.persistSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)?(this.parent.getDataModule().isRemote()||!(0,s.hX)(this.parent.dataSource)&&this.parent.dataSource.result?this.parent.totalDataRecordsCount:this.getData()&&this.getData().length)===i.length&&(t=i.filter(function(e){return e.isSelectable}).length)&&e===t:this.parent.allowPaging&&this.parent.selectionSettings.persistSelection?(t=this.parent.partialSelectedRecords.length+this.parent.disableSelectedRecords.length)===this.totalRecordsCount&&this.parent.partialSelectedRecords.length&&e===this.parent.partialSelectedRecords.length:(t=i.filter(function(e){return e.isSelectable}).length)&&e===t},e.prototype.keyDownHandler=function(e){("opera"===s.Pw.info.name&&17===e.keyCode||"mozilla"===s.Pw.info.name&&224===e.keyCode||("safari"===s.Pw.info.name||"chrome"===s.Pw.info.name)&&(91===e.keyCode||93===e.keyCode))&&(this.cmdKeyPressed=!0);var t=(0,n.oC)(e.target,"e-headercell"),i=(0,n.oC)(e.target,a.Jt);(t?t.children[0].classList.contains("e-headerchkcelldiv"):!!i&&i.classList.contains("e-gridchkbox"))&&!this.parent.allowKeyboard&&32===e.keyCode&&e.preventDefault()},e.prototype.keyUpHandler=function(e){("opera"===s.Pw.info.name&&17===e.keyCode||"mozilla"===s.Pw.info.name&&224===e.keyCode||("safari"===s.Pw.info.name||"chrome"===s.Pw.info.name)&&(91===e.keyCode||93===e.keyCode))&&(this.cmdKeyPressed=!1)},e.prototype.clickHandler=function(e){var t,i=e.target;this.actualTarget=i,this.isAutoFillSel||e.ctrlKey||e.shiftKey||(this.startAFCell=this.endAFCell=null),this.selectionSettings.persistSelection&&(this.deSelectedData=(0,n.pA)(this.persistSelectedData)),((0,n.oC)(i,a.nM)||(0,n.oC)(i,"e-headerchkcelldiv")||this.selectionSettings.allowColumnSelection&&i.classList.contains("e-headercell"))&&(this.isInteracted=!0),this.cmdKeyPressed=e.metaKey,this.isMultiCtrlRequest=e.ctrlKey||this.enableSelectMultiTouch||this.isMacOS&&this.cmdKeyPressed,this.parent.allowKeyboard?this.isMultiShiftRequest=e.shiftKey:(this.isMultiShiftRequest=!1,this.isMultiCtrlRequest=!1),this.isMultiCtrlRequestCell=this.isMultiCtrlRequest,this.popUpClickHandler(e);var l=!1;this.preventFocus=!0;var r=(0,n.oC)(i,"e-checkbox-wrapper");if(this.checkSelectAllClicked=!!(r&&r.getElementsByClassName("e-checkselectall")||this.selectionSettings.persistSelection&&(0,n.oC)(i,a.nM)),this.selectionSettings.persistSelection&&this.isPartialSelection&&(0,n.oC)(i,"e-headerchkcelldiv")&&!i.querySelector(".e-checkbox-disabled")&&(this.isHdrSelectAllClicked=!0),r&&r.querySelectorAll(".e-checkselect,.e-checkselectall").length>0&&(t=r.querySelector('input[type="checkbox"]'),l=!0),this.drawBorders(),this.updateAutoFillPosition(),i=(0,n.oC)(i,a.Jt),this.parent.isReact&&i&&!i.parentElement&&i.classList.contains("e-rowcell")&&(i=this.parent.getCellFromIndex(parseInt(i.getAttribute("index"),10),parseInt(i.getAttribute("data-colindex"),10))),this.isRowDragSelected&&(0,s.hX)(i)&&this.parent.allowRowDragAndDrop&&this.selectionSettings.persistSelection&&this.checkSelectAllClicked&&(this.isRowDragSelected=!1),(i&&i.parentElement.classList.contains(a.nM)&&!this.parent.selectionSettings.checkboxOnly||l)&&!this.isRowDragSelected){if(this.parent.isCheckBoxSelection&&(this.isMultiCtrlRequest=!0),this.target=i,(0,s.hX)(t)){var o=0;o=parseInt(i.parentElement.getAttribute(a.bB),10),this.parent.isPersistSelection&&!this.parent.editSettings.showAddNewRow&&this.parent.element.getElementsByClassName(a.jm).length>0&&++o,this.mUPTarget&&this.mUPTarget.isEqualNode(i)||this.rowCellSelectionHandler(o,parseInt(i.getAttribute(a.Pc),10)),this.parent.isCheckBoxSelection&&(this.moveIntoUncheckCollection((0,s.kp)(i,"."+a.nM)),this.setCheckAllState())}else this.checkedTarget=t,t.classList.contains("e-checkselectall")?this.checkSelectAll(t):this.checkSelect(t);this.parent.isCheckBoxSelection||!s.Pw.isDevice||this.isSingleSel()||this.showPopup(e)}else if(e.target.classList.contains("e-headercell")&&!e.target.classList.contains("e-stackedheadercell")){var h=e.target.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");this.headerSelectionHandler(this.parent.getColumnIndexByUid(h))}this.isMultiCtrlRequest=!1,this.isMultiCtrlRequestCell=this.isMultiCtrlRequest,this.isMultiShiftRequest=!1,(0,s.hX)((0,s.kp)(e.target,".e-unboundcell"))&&(this.preventFocus=!1)},e.prototype.popUpClickHandler=function(e){var t=e.target;(0,s.kp)(t,".e-headercell")||e.target.classList.contains(a.Jt)||(0,s.kp)(t,".e-gridpopup")?t.classList.contains("e-rowselect")&&(t.classList.contains("e-spanclicked")?(t.classList.remove("e-spanclicked"),this.enableSelectMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(t.classList.add("e-spanclicked"),this.enableSelectMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"},e.prototype.showPopup=function(e){this.selectionSettings.enableSimpleMultiRowSelection||(0,n.TJ)(this.parent.element.querySelector(".e-gridpopup"),e,"e-rowselect e-icons e-icon-rowselect"+(!this.isSingleSel()&&(this.selectedRecords.length>1||this.selectedRowCellIndexes.length>1)?" e-spanclicked":""))},e.prototype.rowCellSelectionHandler=function(e,t){if(!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel())this.isDragged||this.selectRow(e,this.selectionSettings.enableToggle),this.selectCell({rowIndex:e,cellIndex:t},this.selectionSettings.enableToggle),this.selectedRowCellIndexes.length&&this.updateAutoFillPosition(),this.drawBorders();else if(this.isMultiShiftRequest)!this.parent.isCheckBoxSelection&&(this.parent.isCheckBoxSelection||(0,s.kp)(this.target,"."+a.Jt).classList.contains(a.yM))?this.addRowsToSelection([e]):this.selectRowsByRange((0,s.b0)(this.prevRowIndex)?e:this.prevRowIndex,e),this.selectCellsByRange((0,s.b0)(this.prevCIdxs)?{rowIndex:e,cellIndex:t}:this.prevCIdxs,{rowIndex:e,cellIndex:t}),this.updateAutoFillPosition(),this.drawBorders();else{if(this.addRowsToSelection([e]),"Both"===this.selectionSettings.mode){var i=this.parent.getColumns().find(function(e){return"checkbox"===e.type}),l=i&&i.index!==t;l&&!this.isMultiCtrlRequestCell?this.selectCell({rowIndex:e,cellIndex:t},this.selectionSettings.enableToggle):(!i||l)&&this.addCellsToSelection([{rowIndex:e,cellIndex:t}])}else this.addCellsToSelection([{rowIndex:e,cellIndex:t}]);this.showHideBorders("none")}this.isDragged=!1},e.prototype.onCellFocused=function(e){if(this.parent.frozenRows&&e.container.isHeader&&e.byKey){if("upArrow"===e.keyArgs.action)this.parent.allowFiltering?e.isJump="INPUT"===e.element.tagName:e.isJump="TH"===e.element.tagName;else if("downArrow"===e.keyArgs.action){var t=Number(e.element.parentElement.getAttribute(a.bB));e.isJump=0===t}else"ctrlHome"===e.keyArgs.action&&(e.isJump=!0)}var i=(e.container.isHeader&&e.isJump||e.container.isContent&&!e.container.isSelectable)&&!(e.byKey&&"space"===e.keyArgs.action)&&!(e.element.classList.contains("e-detailrowexpand")||e.element.classList.contains("e-detailrowcollapse")),l=e.container.isHeader&&"TD"!==e.element.tagName&&!(0,s.kp)(e.element,"."+a.Jt)&&!(e.byKey&&"space"===e.keyArgs.action);if(!e.byKey||i){i&&!this.parent.isCheckBoxSelection&&this.clearSelection();return}var n=e.container.isContent?e.container.indexes:e.indexes,r=n[0],o=n[1],h=this.focus.getPrevIndexes();if((e.element.parentElement.querySelector(".e-rowcelldrag")||e.element.parentElement.querySelector(".e-dtdiagonalright")||e.element.parentElement.querySelector(".e-dtdiagonaldown"))&&(h.cellIndex=h.cellIndex-1),this.parent.frozenRows){if(e.container.isHeader&&("TD"===e.element.tagName||(0,s.kp)(e.element,"."+a.Jt))){var c=this.parent.getHeaderTable().querySelector("thead").childElementCount;this.parent.editSettings.showAddNewRow&&"Top"===this.parent.editSettings.newRowPosition&&"upArrow"===e.keyArgs.action&&c++,r-=c,h.rowIndex=(0,s.hX)(h.rowIndex)?null:h.rowIndex-c}else r+=this.parent.frozenRows,h.rowIndex=0!==h.rowIndex&&(0,s.hX)(h.rowIndex)?null:h.rowIndex+this.parent.frozenRows}if(this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache&&(r=parseInt(e.element.parentElement.getAttribute("data-rowindex"),10)),!l&&(-1!==["ctrlPlusA","escape"].indexOf(e.keyArgs.action)||"space"===e.keyArgs.action||r!==h.rowIndex||o!==h.cellIndex)||this.selectionSettings.allowColumnSelection){this.parent.enableVirtualization&&this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&(r=parseInt(e.element.parentElement.getAttribute("data-rowindex"),10)),this.parent.editSettings.showAddNewRow&&"Top"===this.parent.editSettings.newRowPosition&&!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling&&"downArrow"===e.keyArgs.action&&r--,this.preventFocus=!0;var d=this.getKeyColIndex(e);if(this.needColumnSelection&&(o=d),this.parent.element.classList.contains("e-gridcell-read")&&("tab"===e.keyArgs.action||"shiftTab"===e.keyArgs.action||"rightArrow"===e.keyArgs.action||"leftArrow"===e.keyArgs.action)){var p=this.target.getAttribute("aria-label");p=this.target.innerHTML+" column header "+this.parent.getColumnByIndex(o).field,this.target.setAttribute("aria-label",p)}switch(e.keyArgs.action){case"downArrow":case"upArrow":case"enter":case"shiftEnter":this.target=e.element,this.isKeyAction=!0,this.applyDownUpKey(r,o);break;case"rightArrow":case"leftArrow":this.applyRightLeftKey(r,o);break;case"shiftDown":case"shiftUp":this.shiftDownKey(r,o);break;case"shiftLeft":case"shiftRight":this.applyShiftLeftRightKey(r,o);break;case"home":case"end":o="end"===e.keyArgs.action?this.getLastColIndex(r):0,this.applyHomeEndKey(r,o);break;case"ctrlHome":case"ctrlEnd":this.applyCtrlHomeEndKey(r,o);break;case"escape":this.clearSelection(),this.parent.clipboardModule&&window.navigator.clipboard.writeText("");break;case"ctrlPlusA":this.ctrlPlusA();break;case"space":this.applySpaceSelection(e.element);break;case"tab":this.parent.editSettings.allowNextRowEdit&&this.selectRow(r)}this.needColumnSelection=!1,this.preventFocus=!1,this.positionBorders(),this.parent.isFrozenGrid()&&(this.showHideBorders("none",!0),this.refreshFrozenBorders()),this.updateAutoFillPosition()}},e.prototype.getKeyColIndex=function(e){var t,i=null,s=e.element.querySelector(".e-stackedheadercelldiv");if(this.selectionSettings.allowColumnSelection&&(0,n.oC)(e.element,"e-columnheader")){if(this.needColumnSelection=!!e.container.isHeader,s){if("rightArrow"===e.keyArgs.action||"leftArrow"===e.keyArgs.action)return i;t=s.getAttribute("e-mappinguid");var l=this.getstackedColumns(this.parent.getColumnByUid(t).columns),r=this.parent.getColumnIndexByUid(l[l.length-1].uid),o=this.parent.getColumnIndexByUid(l[0].uid);i=this.prevColIndex>=r?o:r}else i=this.parent.getColumnIndexByUid(e.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"))}return i},e.prototype.ctrlPlusA=function(){if(this.isRowType()&&!this.isSingleSel()){var e=this.parent.getRowsObject();this.selectRowsByRange(e[0].index,e[e.length-1].index)}this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange({rowIndex:0,cellIndex:0},{rowIndex:this.parent.getRows().length-1,cellIndex:this.parent.getColumns().length-1})},e.prototype.applySpaceSelection=function(e){e.classList.contains("e-checkselectall")?(this.checkedTarget=e,this.checkSelectAll(this.checkedTarget)):e.classList.contains("e-checkselect")&&(this.checkedTarget=e,this.checkSelect(this.checkedTarget))},e.prototype.applyDownUpKey=function(e,t){var i=this.parent;!this.parent.isCheckBoxSelection||"Check"!==this.parent.checkAllRows||this.selectionSettings.persistSelection||this.selectionSettings.checkboxOnly||(this.checkSelectAllAction(!1),this.checkedTarget=null),this.isRowType()&&!this.selectionSettings.checkboxOnly&&(this.parent.frozenRows,this.selectRow(e,!0),this.applyUpDown(i.selectedRowIndex)),this.isCellType()&&this.selectCell({rowIndex:e,cellIndex:t},!0),this.selectionSettings.allowColumnSelection&&this.needColumnSelection&&this.selectColumn(t)},e.prototype.applyUpDown=function(e){if(!(e<0)){this.target||(this.target=this.parent.getRows()[0].children[this.parent.groupSettings.columns.length||0]);var t=parseInt(this.target.getAttribute(a.Pc),10),i=this.contentRenderer.getRowByIndex(e);if(i&&(this.target=i.getElementsByClassName(a.Jt)[parseInt(t.toString(),10)]),this.addAttribute(this.target),this.parent.element.classList.contains("e-gridcell-read")){var s=this.target.getAttribute("aria-label");s=this.target.innerHTML,this.target.setAttribute("aria-label",s)}}},e.prototype.applyRightLeftKey=function(e,t){this.selectionSettings.allowColumnSelection&&this.needColumnSelection?this.selectColumn(t):this.isCellType()&&(this.selectCell({rowIndex:e,cellIndex:t},!0),this.addAttribute(this.target))},e.prototype.applyHomeEndKey=function(e,t){this.isCellType()?this.selectCell({rowIndex:e,cellIndex:t},!0):this.addAttribute(this.parent.getCellFromIndex(e,t))},e.prototype.shiftDownKey=function(e,t){this.isMultiShiftRequest=!0,this.isRowType()&&!this.isSingleSel()&&((0,s.b0)(this.prevRowIndex)?this.isPartialSelection?this.selectRow(e,!0):this.selectRow(0,!0):(this.selectRowsByRange(this.prevRowIndex,e),this.applyUpDown(e))),this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange(this.prevCIdxs||{rowIndex:0,cellIndex:0},{rowIndex:e,cellIndex:t}),this.isMultiShiftRequest=!1},e.prototype.applyShiftLeftRightKey=function(e,t){this.isMultiShiftRequest=!0,this.selectionSettings.allowColumnSelection&&this.needColumnSelection?this.selectColumnsByRange(this.prevColIndex,t):this.selectCellsByRange(this.prevCIdxs,{rowIndex:e,cellIndex:t}),this.isMultiShiftRequest=!1},e.prototype.getstackedColumns=function(e){for(var t=[],i=0,s=e.length;i<s;i++)e[parseInt(i.toString(),10)].columns?this.getstackedColumns(e[parseInt(i.toString(),10)].columns):t.push(e[parseInt(i.toString(),10)]);return t},e.prototype.applyCtrlHomeEndKey=function(e,t){this.isRowType()&&(this.selectRow(e,!0),this.addAttribute(this.parent.getCellFromIndex(e,t))),this.isCellType()&&this.selectCell({rowIndex:e,cellIndex:t},!0)},e.prototype.addRemoveClassesForRow=function(e,t,i){for(var s=[],l=3;l<arguments.length;l++)s[l-3]=arguments[l];if(e){var r=[].slice.call(e.getElementsByClassName(a.Jt)),o=e.querySelector(".e-detailrowcollapse")||e.querySelector(".e-detailrowexpand"),h=e.querySelector(".e-rowdragdrop");o&&r.push(o),h&&r.push(h),n.yR.apply(void 0,[r,t].concat(s))}this.getRenderer().setSelection(e?e.getAttribute("data-uid"):null,t,i)},e.prototype.isRowType=function(){return"Row"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode},e.prototype.isCellType=function(){return"Cell"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode},e.prototype.isSingleSel=function(){return"Single"===this.selectionSettings.type},e.prototype.getRenderer=function(){return(0,s.hX)(this.contentRenderer)&&(this.contentRenderer=this.factory.getRenderer(o.nJ.Content)),this.contentRenderer},e.prototype.getSelectedRecords=function(){return!this.selectionSettings.persistSelection&&this.selectedRecords.length?this.parent.getRowsObject().filter(function(e){return e.isSelected}).map(function(e){return e.data}):this.persistSelectedData},e.prototype.selectColumn=function(e){var t=this.parent;if(!(0,s.hX)(t.getColumns()[parseInt(e.toString(),10)])){var i=t.getColumnByIndex(e),l=t.getColumnHeaderByUid(i.uid),n=l.classList.contains("e-columnselection");if(t.selectionSettings.allowColumnSelection){var o=this.selectedColumnsIndexes.length>1&&this.selectedColumnsIndexes.indexOf(e)>-1;if(this.clearColDependency(),!this.selectionSettings.enableToggle||o||!n){var a={columnIndex:e,headerCell:l,column:i,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(a,r.fvJ),a.cancel){this.disableInteracted();return}(o||!(n&&t.selectionSettings.enableToggle&&e===this.prevColIndex))&&this.updateColSelection(l,e);var h={columnIndex:e,headerCell:l,column:i,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(h,r.Q0g)}this.updateColProps(e)}}},e.prototype.selectColumnsByRange=function(e,t){var i=this.parent;if(!(0,s.hX)(i.getColumns()[parseInt(e.toString(),10)])){var l=[];if("Single"===i.selectionSettings.type||(0,s.hX)(t))l[0]=e;else for(var n=e<t,r=e;n?r<=t:r>=t;n?r++:r--)l.push(r);this.selectColumns(l)}},e.prototype.selectColumns=function(e){var t=this.parent,i=this.getselectedCols();if("Single"===t.selectionSettings.type&&(e=[e[0]]),t.selectionSettings.allowColumnSelection){this.clearColDependency();var s={columnIndex:e[0],headerCell:i,columnIndexes:e,column:t.getColumnByIndex(e[0]),cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(s,r.fvJ),s.cancel){this.disableInteracted();return}for(var l=0,n=e.length;l<n;l++)this.updateColSelection(t.getColumnHeaderByUid(t.getColumnByIndex(e[parseInt(l.toString(),10)]).uid),e[parseInt(l.toString(),10)]);i=this.getselectedCols();var o={columnIndex:e[0],headerCell:i,columnIndexes:e,column:t.getColumnByIndex(e[0]),target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(o,r.Q0g),this.updateColProps(e[0])}},e.prototype.selectColumnWithExisting=function(e){var t=this.parent;if(!(0,s.hX)(t.getColumns()[parseInt(e.toString(),10)])){var i=t.getColumnHeaderByUid(t.getColumnByIndex(e).uid),l=this.getselectedCols();if("Single"===t.selectionSettings.type&&this.clearColDependency(),t.selectionSettings.allowColumnSelection){if(this.selectedColumnsIndexes.indexOf(e)>-1)this.clearColumnSelection(e);else{var n={columnIndex:e,headerCell:l,columnIndexes:this.selectedColumnsIndexes,column:t.getColumnByIndex(e),cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(n,r.fvJ),n.cancel){this.disableInteracted();return}this.updateColSelection(i,e);var o={columnIndex:e,headerCell:l=this.getselectedCols(),column:t.getColumnByIndex(e),columnIndexes:this.selectedColumnsIndexes,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(o,r.Q0g)}this.updateColProps(e)}}},e.prototype.clearColumnSelection=function(e){if(this.isColumnSelected){var t=this.parent;if((0,s.hX)(e)||-1!==this.selectedColumnsIndexes.indexOf(e)){var i=(0,s.hX)(e)?this.selectedColumnsIndexes[this.selectedColumnsIndexes.length-1]:e,l=t.getColumnByIndex(i),o=t.getColumnHeaderByUid(l.uid),a={columnIndex:i,headerCell:o,columnIndexes:this.selectedColumnsIndexes,column:l,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted};if(this.columnDeselect(a,r.MLr)){this.disableInteracted();return}for(var h=(0,s.hX)(e)?[].slice.call(t.getHeaderContent().getElementsByClassName("e-columnselection")):[o],c=this.getSelectedColumnCells(e),d=0,p=h.length;d<p;d++)(0,n.yR)([h[parseInt(d.toString(),10)]],!1,"e-columnselection");for(var d=0,p=c.length;d<p;d++)(0,n.yR)([c[parseInt(d.toString(),10)]],!1,"e-columnselection");(0,s.hX)(e)?(this.columnDeselect(a,r.zTL),this.selectedColumnsIndexes=[],this.isColumnSelected=!1,this.parent.getColumns().filter(function(e){return e.isSelected=!1})):(this.selectedColumnsIndexes.splice(this.selectedColumnsIndexes.indexOf(e),1),this.parent.getColumns()[parseInt(e.toString(),10)].isSelected=!1)}}},e.prototype.getselectedCols=function(){var e,t=this.parent;if(this.selectedColumnsIndexes.length>1){e=[];for(var i=0;i<this.selectedColumnsIndexes.length;i++)e.push(t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[parseInt(i.toString(),10)]).uid))}else e=t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[0]).uid);return e},e.prototype.getSelectedColumnCells=function(e){for(var t=this.parent,i=(0,s.hX)(this.parent.rowTemplate)?t.getDataRows():t.getRows(),l=[],n=(0,s.hX)(e)?".e-columnselection":'[data-colindex="'+e+'"]',r=0,o=i.length;r<o;r++)l=l.concat([].slice.call(i[parseInt(r.toString(),10)].querySelectorAll(n)));return l},e.prototype.columnDeselect=function(e,t){return"columnDeselected"===t&&delete e.cancel,this.onActionComplete(e,t),e.cancel},e.prototype.updateColProps=function(e){this.prevColIndex=e,this.isColumnSelected=this.selectedColumnsIndexes.length&&!0},e.prototype.clearColDependency=function(){this.clearColumnSelection(),this.selectedColumnsIndexes=[]},e.prototype.updateColSelection=function(e,t){if(!(0,s.hX)(this.parent.getColumns()[parseInt(t.toString(),10)])){var i=(0,s.hX)(this.parent.rowTemplate)?this.parent.getDataRows():this.parent.getRows();this.selectedColumnsIndexes.push(t),this.parent.getColumns()[parseInt(t.toString(),10)].isSelected=!0,t+=this.parent.getIndentCount(),(0,n.yR)([e],!0,"e-columnselection");for(var l=0,r=i.length;l<r;l++)if(i[parseInt(l.toString(),10)].classList.contains(a.nM)){if((i[parseInt(l.toString(),10)].classList.contains(a.QF)||i[parseInt(l.toString(),10)].classList.contains(a.jm))&&"Normal"===this.parent.editSettings.mode&&!(0,s.hX)(i[parseInt(l.toString(),10)].querySelector("tr").childNodes[parseInt(t.toString(),10)]))(0,n.yR)([i[parseInt(l.toString(),10)].querySelector("tr").childNodes[parseInt(t.toString(),10)]],!0,"e-columnselection");else if(this.parent.isSpan&&this.parent.isFrozenGrid())for(var o=i[parseInt(l.toString(),10)].querySelectorAll(".e-rowcell"),h=0;h<o.length;h++)o[parseInt(h.toString(),10)].getAttribute("aria-colindex")===e.getAttribute("aria-colindex")&&(0,n.yR)([o[parseInt(h.toString(),10)]],!0,"e-columnselection");else(0,s.hX)(i[parseInt(l.toString(),10)].childNodes[parseInt(t.toString(),10)])||(0,n.yR)([i[parseInt(l.toString(),10)].childNodes[parseInt(t.toString(),10)]],!0,"e-columnselection")}}},e.prototype.headerSelectionHandler=function(e){!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel()?this.selectColumn(e):this.isMultiShiftRequest?this.selectColumnsByRange((0,s.b0)(this.prevColIndex)?e:this.prevColIndex,e):this.selectColumnWithExisting(e)},e.prototype.addEventListener_checkbox=function(){var e=this;this.parent.on(r.yUO,this.dataReady,this),this.onDataBoundFunction=this.onDataBound.bind(this),this.parent.addEventListener(r.BPR,this.onDataBoundFunction),this.parent.on(r.UqJ,this.onDataBoundFunction),this.parent.on(r.PRb,this.checkBoxSelectionChanged,this),this.parent.on(r.eAe,this.initPerisistSelection,this),this.parent.on(r.DjW,this.setCheckAllForEmptyGrid,this),this.actionCompleteFunc=this.actionCompleteHandler.bind(this),this.parent.addEventListener(r.wn6,this.actionCompleteFunc),this.parent.on(r.jMr,this.clickHandler,this),this.resizeEndFn=function(){e.updateAutoFillPosition(),e.drawBorders()},this.resizeEndFn.bind(this),this.parent.addEventListener(r.D5n,this.resizeEndFn)},e.prototype.removeEventListener_checkbox=function(){this.parent.off(r.yUO,this.dataReady),this.parent.removeEventListener(r.BPR,this.onDataBoundFunction),this.parent.removeEventListener(r.wn6,this.actionCompleteFunc),this.parent.off(r.UqJ,this.onDataBoundFunction),this.parent.off(r.DjW,this.setCheckAllForEmptyGrid),this.parent.off(r.jMr,this.clickHandler),this.parent.removeEventListener(r.D5n,this.resizeEndFn),this.parent.off(r.eAe,this.initPerisistSelection)},e.prototype.setCheckAllForEmptyGrid=function(){var e=this.getCheckAllBox();if(e){this.parent.isCheckBoxSelection=!0;var t=e.nextElementSibling;(0,s.vy)([t],["e-check","e-stop","e-uncheck"]),(0,s.iQ)([t.parentElement],["e-checkbox-disabled"])}},e.prototype.dataReady=function(e){this.isHeaderCheckboxClicked=!1;var t=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.requestType;"virtualscroll"===e.requestType||this.parent.isPersistSelection||t||(this.disableUI=!this.parent.enableImmutableMode&&!("save"===e.requestType&&"add"===e.action),this.clearSelection(),this.setCheckAllState(),this.disableUI=!1)},e.prototype.actionCompleteHandler=function(e){"save"===e.requestType&&this.parent.isPersistSelection&&this.refreshPersistSelection()},e.prototype.selectRowIndex=function(e){this.parent.isSelectedRowIndexUpdating=!0,(0,s.hX)(this.parent.selectedRowIndex)||-1===this.parent.selectedRowIndex||!this.parent.enablePersistence?this.parent.selectedRowIndex=e:this.parent.selectedRowIndex=-1},e.prototype.disableInteracted=function(){this.isInteracted=!1},e.prototype.activeTarget=function(){this.actualTarget=this.isInteracted?this.actualTarget:null},e}()}}]);